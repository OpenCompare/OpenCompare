"use strict";angular.module("openCompareEditor",["ui.grid","ui.grid.edit","ui.grid.selection","ui.grid.cellNav","ui.grid.resizeColumns","ui.grid.moveColumns","ui.grid.autoResize","ui.bootstrap","ui.slider","ui.grid.pinning","chart.js","pascalprecht.translate","ab-base64","naif.base64","angular-clipboard"]),Array.prototype.move=function(a,b){if(b>=this.length)for(var c=b-this.length;c--+1;)this.push(void 0);return this.splice(b,0,this.splice(a,1)[0]),this},angular.module("openCompareEditor").directive("ocEditor",["openCompareServer","componentUtils",function(a,b){return{restrict:"E",scope:{pcmContainer:"=",config:"=?",state:"=?"},controller:["$scope",function(a){var b=this;b.pcmContainer=a.pcmContainer,a.$watchCollection("pcmContainer",function(a){"undefined"!=typeof a&&(b.pcmContainer=a)}),"undefined"==typeof a.config&&(a.config={}),b.config=a.config,"undefined"==typeof a.state&&(a.state={}),b.state=a.state}],link:function(b,c,d){b.$watch("config.serverMode",function(c){switch(c){case"client":a.useClient();break;case"local":a.useLocalServer();break;case"remote":a.useRemoteServer(b.config.serverAddress)}})}}}]),angular.module("openCompareEditor").service("componentUtils",function(){this.defineOption=function(a,b,c){for(var d=a,e=0;e<b.length-1;e++){var f=d[b[e]];"undefined"==typeof f&&(f={}),d=f}var g=b[b.length-1];"undefined"==typeof d[g]&&(d[g]=c)}}),angular.module("openCompareEditor").directive("ocGrid",["componentUtils",function(a){return{restrict:"E",require:"^ocEditor",templateUrl:"grid/templates/pcmEditor.html",scope:{},link:function(b,c,d,e){b.pcmContainer=e.pcmContainer,b.$watchCollection("pcmContainer",function(a){"undefined"!=typeof a&&(b.pcmContainer=e.pcmContainer,b.pcm=e.pcmContainer.pcm,b.metadata=e.pcmContainer.metadata,b.id=e.pcmContainer.id)}),b.config=e.config,b.state=e.state,a.defineOption(b.state,["edit"],!1),a.defineOption(b.state,["configurator"],!1),a.defineOption(b.state,["validating"],!1),a.defineOption(b.state,["canUndo"],!1),a.defineOption(b.state,["canRedo"],!1),a.defineOption(b.state,["lineView"],!0),a.defineOption(b.state,["height"],1)}}}]),angular.module("openCompareEditor").directive("superColWidthUpdate",["$timeout","$rootScope",function(a,b){return{restrict:"A",link:function(c,d){var e=(c.col.colDef.superCol,jQuery(d),function(){var b=c.col.colDef.superCol,e=jQuery(d);a(function(){if(b){var a=jQuery('.ui-grid-header-cell[col-name="'+b+'"]'),c=a.outerWidth(),d=e.outerWidth();c=(1===c?0:c)+d,a.css({"min-width":c+"px","max-width":c+"px","text-align":"center"})}},0)}),f=function(){var b=c.col.colDef.superCol;jQuery(d);a(function(){if(b){var a=jQuery('.ui-grid-header-cell[col-name="'+b+'"]');a.css({"min-width":"0px","max-width":"0px"}),e()}},0)};b.$on("reloadFeatureGroup",f)}}}]),angular.module("openCompareEditor").directive("ocToolbar",["componentUtils",function(a){return{restrict:"E",require:"^ocEditor",scope:{},templateUrl:"toolbar/toolbar.html",controller:"ToolbarCtrl",link:function(b,c,d,e){b.pcmContainer=e.pcmContainer,b.$watchCollection("pcmContainer",function(a){"undefined"!=typeof a&&(b.pcmContainer=e.pcmContainer,b.pcm=e.pcmContainer.pcm,b.metadata=e.pcmContainer.metadata,b.id=e.pcmContainer.id)}),b.config=e.config,b.state=e.state,a.defineOption(b.config,["enableToolbar"],!0),a.defineOption(b.config,["enableTitle"],!0),a.defineOption(b.config,["enableEdit"],!0),a.defineOption(b.config,["enableExport"],!0),a.defineOption(b.config,["enableShare"],!0),a.defineOption(b.state,["edit"],!1),a.defineOption(b.state,["configurator"],!1),a.defineOption(b.state,["validating"],!1),a.defineOption(b.state,["canUndo"],!1),a.defineOption(b.state,["canRedo"],!1),a.defineOption(b.state,["lineView"],!0),a.defineOption(b.state,["height"],1)}}}]),angular.module("openCompareEditor").controller("ToolbarCtrl",["$rootScope","$scope","$modal","componentUtils",function(a,b,c,d){b.validating=!1,b.configurator=!1,b.lineView=!0,b.launchFromCreator=!1,b.isTitleSet=!1,b.save=function(){a.$broadcast("save")},b.remove=function(){"undefined"!=typeof b.id&&openCompareServer.get("/api/remove/"+b.id).then(function(){window.location.href="/"})},b.setConfigurator=function(a){b.state.configurator=a},b.openCreateFeatureGroupModal=function(){b.$modalInstance=c.open({templateUrl:"toolbar/modalCreateFeatureGroup.html",scope:b,controller:"ToolbarCtrl"})},b.isAFeature=function(a){return" "!=a.name&&"Product"!=a.name},b.addFeatureGroup=function(c,d){a.$broadcast("addFeatureGroup",{featureGroup:c,features:d}),b.$modalInstance.close()},b.addProduct=function(){a.$broadcast("addProduct")},b.cancelModal=function(){b.$modalInstance.close()},b["export"]=function(b){a.$broadcast("export",b)},b.toggleValidation=function(){b.state.validating=!b.state.validating},b.setEdit=function(a,c){b.state.edit=a},b.increaseHeight=function(a){b.state.height=a},b.undo=function(){a.$broadcast("undo")},b.redo=function(){a.$broadcast("redo")},b.$watch("pcm.name",function(a){"undefined"!=typeof a&&(b.isTitleSet=a.length>0)})}]),angular.module("openCompareEditor").controller("ShareCtrl",["$scope",function(a){a.enableEditOption=!0,a.enableExportOption=!0,a.enableTitleOption=!0,a.enableShareOption=!0,a.enableConfiguratorOption=!0,a.enableChartsOption=!0,a.updateShareLinks=function(){a.updateEmbedLink(),a.activeShareButton=!0,a.twitterLink="https://twitter.com/intent/tweet?text=%23opencompare&url=http://opencompare.org/pcm/"+a.id,a.facebookLink="https://www.facebook.com/sharer/sharer.php?u=http://opencompare.org/pcm/"+a.id,a.emailLink="mailto:?body=http://opencompare.org/pcm/"+a.id,a.googleLink="https://plus.google.com/share?url=http://opencompare.org/pcm/"+a.id,a.redditLink="http://www.reddit.com/submit?url=http://opencompare.org/pcm/"+a.id},a.updateEmbedLink=function(){a.embedLink='<iframe src="http://'+window.location.hostname+":"+window.location.port+"/embed/pcm/"+a.id+"?enableEdit="+a.enableEditOption+"&enableExport="+a.enableExportOption+"&enableTitle="+a.enableTitleOption+"&enableShare="+a.enableShareOption+"&enableConfigurator="+a.enableConfiguratorOption+"&enableCharts="+a.enableChartsOption+'" scrolling="no"  width="100%" height="700px" style="border:none;"></iframe>'}}]),angular.module("openCompareEditor").directive("ocTitle",["componentUtils",function(a){return{restrict:"E",require:"^ocEditor",scope:{},templateUrl:"title/title.html",controller:function(){},link:function(b,c,d,e){b.pcmContainer=e.pcmContainer,b.config=e.config,b.state=e.state,a.defineOption(b.state,["edit"],!1),a.defineOption(b.state,["saved"],!1),b.$watchCollection("pcmContainer",function(a){"undefined"!=typeof a&&(b.pcm=e.pcmContainer.pcm,b.metadata=e.pcmContainer.metadata,b.id=e.pcmContainer.id)})}}}]),angular.module("openCompareEditor").controller("EditorCtrl",["$controller","$rootScope","$scope","$timeout","uiGridConstants","$compile","$modal","expandeditor","$location","pcmApi","editorUtil","openCompareServer","componentUtils",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){var b=j.factory.createPCM();b.name=c.pcm.name;var d={},e={},f=0;return a.forEach(function(a){var g=j.factory.createProduct();b.addProducts(g);var h=c.gridOptions.superColDefs,i=c.gridOptions.columnDefs;if(h.length>0){for(var l=0;l<h.length;l++){var m=k.convertStringToPCMFormat(h[l].name),n=h[l].name;if(!e.hasOwnProperty(n))if("emptyFeatureGroup"!=n){var o=j.factory.createFeatureGroup();o.name=m,e[m]=o;for(var p=c.getFeaturesWithThisFeatureGroup(n,i),q=0;q<p.length;q++)if(!d.hasOwnProperty(k.convertStringToPCMFormat(p[q]))&&" "!==p[q]&&"Product"!==p[q]){var r=j.factory.createFeature();r.name=k.convertStringToPCMFormat(p[q]),o.addSubFeatures(r),d[k.convertStringToPCMFormat(p[q])]=r}b.addFeatures(o)}else for(var p=c.getFeaturesWithThisFeatureGroup(h[l].name,i),s=0;s<p.length;s++)if(!d.hasOwnProperty(p[s])&&" "!==p[s]&&"Product"!==p[s]){e[k.convertStringToPCMFormat(h[l].name)]="empty";var r=j.factory.createFeature();r.name=k.convertStringToPCMFormat(p[s]),d[k.convertStringToPCMFormat(p[s])]=r,b.addFeatures(r)}}c.gridOptions.columnDefs.forEach(function(b){var e=k.convertStringToPCMFormat(b.name),h=b.name;if(a.hasOwnProperty(e)&&" "!==e&&"Product"!==e){var i=d[e],l=j.factory.createCell();l.feature=i,l.content=a[h],l.rawContent=c.pcmDataRaw[f][h],g.addCells(l)}})}else c.gridOptions.columnDefs.forEach(function(e){var h=k.convertStringToPCMFormat(e.name),i=e.name;if(a.hasOwnProperty(h)&&" "!==i&&"Product"!==i){if(!d.hasOwnProperty(h)){var l=j.factory.createFeature();l.name=h,b.addFeatures(l),d[h]=l}var l=d[h],m=j.factory.createCell();m.feature=l,m.content=a[i],m.rawContent=c.pcmDataRaw[f][i],g.addCells(m)}});f++}),b.features.array.forEach(function(a){a.name===c.productsKey&&(b.productsKey=a)}),j.encodePCM(b),b}function o(a,b){"undefined"==typeof c.metadata&&(c.metadata={});var d=c.metadata;d.featurePositions=[],d.productPositions=[];var e=0;return a.forEach(function(a){var b={};b.product=a[c.productsKey],b.position=e,d.productPositions.push(b),e++}),e=0,b.forEach(function(a){var b={};b.feature=k.convertStringToPCMFormat(a.name),b.position=e,d.featurePositions.push(b),e++}),d}$.material&&$.material.init();var p={$scope:c,$location:i};a("GridCtrl",p),a("UndoRedoCtrl",p),a("CommandsCtrl",p),a("FiltersCtrl",p),a("TypesCtrl",p),a("FeatureGroupCtrl",p),c.$watch("pcm",function(){"undefined"!=typeof c.pcm&&d(function(){c.initializeEditor(c.pcm,c.metadata,!1,!0)},100)}),c.export_content=null,c.oldFeatureName="",c.featureName="",c.loaded=!1,c.lineView=!0,c.$watch("state.edit",function(a){c.gridOptions.columnDefs=[],c.gridOptions.rowHeight=35,c.state.edit=a,c.state.configurator=!1,"undefined"!=typeof c.pcm&&d(function(){c.initializeEditor(c.pcm,c.metadata,!1,!0)},100)}),c.cancel=function(){c.state.edit=!1},c.$watch("state.height",function(a){c.gridOptions.rowHeight=35*a,c.setGridHeight()}),c.$on("goToCell",function(a,b){c.scrollToFocus(b.row,b.col)}),c.$on("addProduct",function(a,b){c.addProduct()}),c.setGridHeight=function(){if(c.pcmData)if(c.pcmData.length*c.gridOptions.rowHeight+100>2*$(window).height()/3&&!c.enableEdit)c.height=2*$(window).height()/3;else if(c.pcmData.length*c.gridOptions.rowHeight+100>$(window).height()&&c.enableEdit){var a=20;("true"==k.GetUrlValue("enableExport")||"true"==k.GetUrlValue("enableShare"))&&(a+=40),"true"==k.GetUrlValue("enableTitle")&&(a+=c.pcm.name.length>30?120:60),c.enableEdit&&(a+=c.state.edit?80:40),c.height=$(window).height()-a}else c.height=c.pcmData.length*c.gridOptions.rowHeight+130},c.scrollToFocus=function(a,b){c.gridApi.cellNav.scrollToFocus(c.pcmData[a],c.gridOptions.columnDefs[b])},c.$on("save",function(a,d){var e=n(c.pcmData);c.metadata=o(c.pcmData,c.gridOptions.columnDefs);var f=JSON.parse(j.serializePCM(e)),g={};g.metadata=c.metadata,g.pcm=f,"undefined"==typeof c.id?l.post("/api/create",g).then(function(a){c.id=a.data,console.log("model created with id="+c.id),b.$broadcast("savedFromCreator",c.id),c.state.saved=!0},function(a){console.error(a)}):l.post("/api/save/"+c.id,g).then(function(){console.log("model saved"),c.state.saved=!0})}),c.$on("export",function(a,b){var d=n(c.pcmData);c.metadata=o(c.pcmData,c.gridOptions.columnDefs);var e=JSON.parse(j.serializePCM(d));c.pcmObject={},c.pcmObject.metadata=c.metadata,c.pcmObject.pcm=e;var f=b.toUpperCase().charAt(0)+b.substring(1);g.open({templateUrl:"templates/modal/modal"+f+"Export.html",controller:f+"ExportCtrl",scope:c,size:"lg"})})}]),angular.module("openCompareEditor").controller("UndoRedoCtrl",["$rootScope","$scope","$timeout","uiGridConstants","sortFeaturesService","editorUtil",function(a,b,c,d,e,f){function g(a,c,d){for(var e=0;e<b.pcmData.length;e++)if(b.pcmData[e].$$hashKey==a){openCompareServer.post("/api/extract-content",{type:"wikipedia",rawContent:d,responseType:"text/plain",transformResponse:function(a,b){return a}}).then(function(a){b.pcmData[e][c]=a.data}),b.pcmDataRaw[e][c]=d,console.log(d);break}}function h(a,c,d){for(var e=0;e<b.pcmData.length;e++)if(b.pcmData[e].$$hashKey==a){openCompareServer.post("/api/extract-content",{type:"wikipedia",rawContent:d,responseType:"text/plain",transformResponse:function(a,b){return a}}).then(function(a){b.pcmData[e][c]=a.data}),b.pcmDataRaw[e][c]=d;break}}function i(a,d,e){b.pcmData.splice(e,0,a),b.pcmDataRaw.splice(e,0,d),c(function(){b.scrollToFocus(e,1)},100),b.setGridHeight()}function j(a){for(var c=!1,d=0;d<b.pcmData.length&&!c;d++)b.pcmData[d].$$hashKey==a&&(b.pcmData.splice(b.pcmData.indexOf(b.pcmData[d]),1),b.pcmDataRaw.splice(b.pcmData.indexOf(b.pcmData[d]),1),c=!0);b.setGridHeight()}function k(a){b.pcmData.push(a),b.pcmDataRaw.push(a),c(function(){b.scrollToFocus(b.pcmData.length-1,1)},100),b.setGridHeight()}function l(a,c,d,e){b.gridOptions.columnDefs.splice(e,0,a),b.pcmData.forEach(function(e){for(var f=0,g=!1;f<c.length&&!g;)e.$$hashKey==c[f][0]&&(e[a.name]=c[f][1],b.pcmDataRaw[f][a.name]=d[f][1],g=!0),f++})}function m(a,c){var d=b.newColumnDef(a,c);b.gridOptions.columnDefs.push(d);var a=f.checkIfNameExists(a,b.gridOptions.columnDefs);b.pcmData.forEach(function(b){b[a]=""}),b.pcmDataRaw.forEach(function(b){b[a]=""}),b.validation[a]=[],b.state.saved=!1}function n(a,c,d){for(var e=f.convertStringToEditorFormat(c),g=f.convertStringToEditorFormat(a),h=!1,i="",j=0;!h&&j<b.gridOptions.columnDefs.length;j++)if(b.gridOptions.columnDefs[j].name===e){i=b.gridOptions.columnDefs[j].type,h=!0;var k=0;b.pcmData.forEach(function(a){a[g]=a[e],b.pcmDataRaw[k][g]=b.pcmDataRaw[k][e],c!=g&&(delete a[e],delete b.pcmDataRaw[k][e]),k++});var l=b.newColumnDef(a,i);b.gridOptions.columnDefs.splice(d,1,l)}b.validation[e]=[],g!=g&&delete b.validation[e]}function o(a,e){for(var f=!1,g=0;g<b.gridOptions.columnDefs.length&&!f;g++)if(b.gridOptions.columnDefs[g].name==a){f=!0,b.gridOptions.columnDefs.splice(g,1);var h=b.newColumnDef(a,e);c(function(){b.gridOptions.columnDefs.splice(g-1,0,h)},100)}b.gridApi.core.notifyDataChange(d.dataChange.COLUMN)}function p(a,c){b.pcmDataRaw.forEach(function(b){delete b[a]}),b.pcmData.forEach(function(b){delete b[a]}),b.gridOptions.columnDefs.splice(c,1)}function q(a){for(var c=0;c<b.gridOptions.columnDefs.length;c++)b.gridOptions.columnDefs[c].superCol==a&&(b.gridOptions.columnDefs[c].superCol="emptyFeatureGroup");var d=0;for(var e in b.gridOptions.superColDefs){if(b.gridOptions.superColDefs[d]&&b.gridOptions.superColDefs[d].name==a){b.gridOptions.superColDefs.splice(d,1);break}d++}}function r(a,c){for(var d=0;d<b.gridOptions.columnDefs.length;d++)for(var f=0;f<c.length;f++)if(c[f]==b.gridOptions.columnDefs[d].name){b.gridOptions.columnDefs[d].superCol=a;break}var g={name:a,displayName:a};b.gridOptions.superColDefs.push(g),b.gridOptions.superColDefs=e.sortFeatureGroupByName(b.gridOptions.superColDefs),b.deleteUnusedFeatureGroups(),b.gridOptions.columnDefs=e.sortByFeatureGroup(b.gridOptions.columnDefs)}function s(a,c){for(var d=0;d<b.gridOptions.columnDefs.length;d++)if(b.gridOptions.columnDefs[d].superCol==c){b.gridOptions.columnDefs[d].superCol=a;break}var f=0;for(var g in b.gridOptions.superColDefs){if(b.gridOptions.superColDefs[f]&&b.gridOptions.superColDefs[f].name==c){b.gridOptions.superColDefs[f].name=a,b.gridOptions.superColDefs[f].displayName=a;break}f++}b.gridOptions.superColDefs=e.sortFeatureGroupByName(b.gridOptions.superColDefs)}b.commands=[],b.commandsIndex=0,b.$on("undo",function(){b.undo()}),b.$on("redo",function(){b.redo()}),b.undo=function(){if(b.commandsIndex>0){b.commandsIndex--,b.state.canRedo=!0;var a=b.commands[b.commandsIndex],c=a[1];switch(a[0]){case"move":b.gridOptions.columnDefs.move(c[1],c[0]);break;case"edit":g(c[0],[c[1]],c[2]);break;case"removeProduct":i(c[1],c[2],c[3]);break;case"addProduct":j(c.$$hashKey);break;case"removeFeature":l(c[0],c[1],c[2],c[3]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"renameFeature":n(c[0],c[1],c[2]);break;case"changeType":o(c[0],c[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"addFeature":p(c[0],c[2]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"addFeatureGroup":q(c[0]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"deleteFeatureGroup":r(c[0],c[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"renameFeatureGroup":s(c[0],c[1]);break;case"assignFeatureGroup":undoAssignFeatureGroup(c[0],c[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs)}b.commandsIndex<=0&&(b.state.canUndo=!1)}b.state.saved=!1},b.redo=function(){if(b.commandsIndex<b.commands.length){var a=b.commands[b.commandsIndex],c=a[1];switch(a[0]){case"move":b.gridOptions.columnDefs.move(c[0],c[1]);break;case"edit":h(c[0],c[1],c[3]);break;case"removeProduct":j(c[0]);break;case"addProduct":k(c);break;case"removeFeature":p(c[0].name,c[3]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"renameFeature":n(c[1],c[0],c[2]);break;case"changeType":o(c[0],c[2]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"addFeature":m(c[0],c[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"addFeatureGroup":r(c[0],c[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"deleteFeatureGroup":q(c[0]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"renameFeatureGroup":s(c[1],c[0]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"assignFeatureGroup":redoAssignFeatureGroup(c[0],c[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs)}b.commandsIndex++,b.state.canUndo=!0,b.commandsIndex>=b.commands.length&&(b.state.canRedo=!1)}b.state.saved=!1}}]),angular.module("openCompareEditor").controller("CommandsCtrl",["$rootScope","$scope","$timeout","uiGridConstants","featureGroupService","sortFeaturesService","editorUtil",function(a,b,c,d,e,f,g){b.newCommand=function(a,c){var d=[];d.push(a),d.push(c),b.commands[b.commandsIndex]=d,b.commandsIndex++,b.state.canUndo=!0},b.addFeature=function(c){c||(c=g.checkIfNameExists(b.featureName,b.gridOptions.columnDefs));var d=g.convertStringToEditorFormat(c);b.pcmData.forEach(function(a){a[d]=""}),b.pcmDataRaw.forEach(function(a){a[d]=""});var e=b.newColumnDef(c,"emptyFeatureName",b.featureType);b.gridOptions.columnDefs.push(e),b.validation[d]=[];var f=[c,b.featureType,b.gridOptions.columnDefs.length-1];b.newCommand("addFeature",f),b.state.saved=!1,a.$broadcast("reloadFeatureGroup")},a.$on("addFeatureGroup",function(a,c){for(var d=c.featureGroup,e=c.features,g=!1,h=0;h<b.gridOptions.superColDefs.length;h++){var i=b.gridOptions.superColDefs[h];i.hasOwnProperty("name")&&"emptyFeatureGroup"==i.name&&(g=!0)}if(!g){var j={name:"emptyFeatureGroup",displayName:" "};b.gridOptions.superColDefs.push(j),b.gridOptions.columnDefs.forEach(function(a){a.superCol="emptyFeatureGroup"})}var k={name:d,displayName:d};b.gridOptions.superColDefs.splice(0,0,k),b.gridOptions.superColDefs=f.sortFeatureGroupByName(b.gridOptions.superColDefs);var l=[];for(var m in e)1==e[m]&&l.push(m);b.gridOptions.columnDefs.forEach(function(a){-1!=l.indexOf(a.name)&&(a.superCol=d)}),b.deleteUnusedFeatureGroups(),b.gridOptions.columnDefs=f.sortByFeatureGroup(b.gridOptions.columnDefs);var n=[d,l];b.newCommand("addFeatureGroup",n),b.state.saved=!1,b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs)}),b.renameFeature=function(){var a=g.convertStringToEditorFormat(b.oldFeatureName),c=g.checkIfNameExists(b.featureName,b.gridOptions.columnDefs),d=g.convertStringToEditorFormat(c),e=0;b.gridOptions.columnDefs.forEach(function(f){if(f.name===a){a===b.featureName&&(c=b.oldFeatureName);var g=0;b.pcmData.forEach(function(c){c[d]=c[a],b.pcmDataRaw[g][d]=b.pcmDataRaw[g][a],b.featureName!=b.oldFeatureName&&(delete c[a],delete b.pcmDataRaw[g][a]),g++});var h=b.newColumnDef(c,f.superCol,f.type);b.gridOptions.columnDefs.splice(e,1,h);var i=[b.oldFeatureName,c,e];b.newCommand("renameFeature",i)}e++}),b.validation[c]=[],b.featureName!=b.oldFeatureName&&delete b.validation[a],b.featureName="",b.oldFeatureName="",b.state.saved=!1},a.$on("renameFeatureGroup",function(c,d){for(var e=d.oldFeatureGroup,f=d.newFeatureGroup,h=g.convertStringToEditorFormat(e),i=(g.checkIfNameExists(f,b.gridOptions.columnDefs),g.convertStringToEditorFormat(f)),j=0;j<b.gridOptions.superColDefs.length;j++)if(b.gridOptions.superColDefs[j].name==h){b.gridOptions.superColDefs[j].name=i,b.gridOptions.superColDefs[j].displayName=i;break}for(var j=0;j<b.gridOptions.columnDefs.length;j++)b.gridOptions.columnDefs[j].superCol===h&&(b.gridOptions.columnDefs[j].superCol=i);var k=[h,i];b.newCommand("renameFeatureGroup",k),b.featureName="",b.state.saved=!1,a.$broadcast("reloadFeatureGroup")}),b.deleteFeatureGroup=function(c){for(var d=0;d<b.gridOptions.superColDefs.length;d++)if(b.gridOptions.superColDefs[d].name==c){b.gridOptions.superColDefs.splice(d,1);break}for(var e=[],d=0;d<b.gridOptions.columnDefs.length;d++)b.gridOptions.columnDefs[d].superCol===c&&(e.push(b.gridOptions.columnDefs[d].name),b.gridOptions.columnDefs[d].superCol="emptyFeatureGroup");var g=[c,e];b.newCommand("deleteFeatureGroup",g),b.gridOptions.columnDefs=f.sortByFeatureGroup(b.gridOptions.columnDefs,b.gridOptions.superColDefs),b.state.saved=!1,a.$broadcast("reloadFeatureGroup")},a.$on("assignFeatureGroup",function(c,d){var e=[];for(var g in d.features)1==d.features[g]&&e.push(g);b.gridOptions.columnDefs.forEach(function(a){-1!=e.indexOf(a.name)?a.superCol=d.featureGroup:a.superCol==d.featureGroup&&(a.superCol="emptyFeatureGroup")}),b.deleteUnusedFeatureGroups(),b.gridOptions.columnDefs=f.sortByFeatureGroup(b.gridOptions.columnDefs),b.state.saved=!1,a.$broadcast("reloadFeatureGroup")}),b.deleteFeature=function(c){delete b.validation[c];var d=0;b.gridOptions.columnDefs.forEach(function(a){if(a.name===c){var e=[],f=[],g=[],h=0;b.pcmData.forEach(function(d){var e=[d.$$hashKey,d[c]],i=[d.$$hashKey,b.pcmDataRaw[h][c]];f.push(e),g.push(i),delete b.pcmData[h][a.name],delete b.pcmDataRaw[h][a.name],h++}),e.push(b.gridOptions.columnDefs[d]),e.push(f),e.push(g),e.push(d),b.newCommand("removeFeature",e),b.gridOptions.columnDefs.splice(d,1)}d++}),console.log("Feature is deleted"),b.state.saved=!1,a.$broadcast("reloadFeatureGroup")},b.changeType=function(){for(var a=b.featureName,e=g.convertStringToEditorFormat(a),f=!1,h=0;h<b.gridOptions.columnDefs.length&&!f;h++)if(b.gridOptions.columnDefs[h].name==e){var i=b.gridOptions.columnDefs[h].type;f=!0,b.gridOptions.columnDefs.splice(h,1),b.gridOptions.columnDefs[h].superCol||(b.gridOptions.columnDefs[h].superCol="emptyFeatureGroup");var j=b.newColumnDef(a,b.gridOptions.columnDefs[h].superCol,b.featureType);c(function(){b.gridOptions.columnDefs.splice(h-1,0,j)},100);var k=[a,i,b.featureType];b.newCommand("changeType",k)}b.gridApi.core.notifyDataChange(d.dataChange.COLUMN)},b.addProduct=function(a){var e={},f=[];a?e.name=a:e.name="",b.gridOptions.columnDefs.forEach(function(a){" "!=a.name&&"Product"!=a.name&&(e[a.name]="",e.name="",f[a.name]="")}),b.pcmDataRaw.push(f),b.pcmData.push(e),b.gridApi.core.notifyDataChange(d.dataChange.COLUMN),c(function(){b.scrollToFocus(b.pcmData.length-1,1)},100),console.log("Product added"),b.state.saved=!1;var g=b.pcmData[b.pcmData.length-1];b.newCommand("addProduct",g),b.setGridHeight()},b.removeProduct=function(a){var c=b.pcmData.indexOf(a.entity),d=b.pcmDataRaw[c];b.pcmData.splice(c,1),b.pcmDataRaw.splice(c,1),b.state.saved=!1;var e=[a.entity.$$hashKey,a.entity,d,c];b.newCommand("removeProduct",e),b.setGridHeight()}}]),angular.module("openCompareEditor").controller("GridCtrl",["$rootScope","$scope","$window","$timeout","uiGridConstants","$location","pcmApi","expandeditor","typeService","editorOptions","editorUtil","sortFeaturesService","chartService","openCompareServer",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a){if(a.files&&a.files[0]){var b=new FileReader;b.onload=function(a){console.log(a.target.result)},b.readAsDataURL(a.files[0])}}function p(a,c,d,f){var g=[],h=!1;if(d.map(function(c){var d=c.name;c.name||(d=" ");var e="emptyFeatureGroup";c.parentGroup&&(e=c.parentGroup.name,h=!0);var f=b.newColumnDef(d,e,i.getType(d,b.pcmData));a.productsKey===c&&(f.pinnedLeft=!0,f.footerCellTemplate="<div class='ui-grid-cell-contents'><span>{{grid.appScope.gridApi.core.getVisibleRows($scope.gridApi.grid).length}} / {{grid.appScope.pcmData.length}}</span></div>"),g.push(f)}),h&&f){b.gridOptions.superColDefs=[];var j={name:"emptyFeatureGroup",displayName:" "};b.gridOptions.superColDefs.push(j),a.features.array.forEach(function(a){var c=!1;if(d.map(function(b){a.name==b.name&&(c=!0)}),!c){var e=a.name,f={name:e,displayName:e};b.gridOptions.superColDefs.splice(0,0,f)}})}c&&(g=k.sortFeatures(b.pcm.features.array,g,c.featurePositions));var m={name:a.productsKey.name,field:"name",cellClass:function(a,b,c,d,e){return"productCell"},enableSorting:!0,enableHiding:!1,enableColumnMoving:!1,enableCellEdit:b.state.edit,enableCellEditOnFocus:b.state.edit,pinnedLeft:!0,allowCellFocus:!0,minWidth:150,width:150,menuItems:[{title:"Unhide everything",icon:"fa fa-eye",action:function(a){b.gridOptions.columnDefs.forEach(function(a){a.visible=!0}),b.gridApi.core.notifyDataChange(e.dataChange.COLUMN)}}]};m.filter=[],m.filter.term="",m.filter.placeholder="Find",m.filterHeaderTemplate="<div class='ui-grid-filter-container'>   <input type='text' class='form-control floating-label' ng-change='grid.appScope.applyProductFilter()' ng-model='grid.appScope.productFilter' placeholder='Find'</div>",m.footerCellTemplate="<div class='ui-grid-cell-contents'><span>{{grid.appScope.gridApi.core.getVisibleRows($scope.gridApi.grid).length}} / {{grid.appScope.pcmData.length}}</span></div>";var n={name:" ",cellTemplate:"templates/toolCellTemplate.html",enableCellEdit:!1,enableFiltering:!1,enableColumnResizing:!1,pinnedLeft:!0,enableSorting:!1,enableHiding:!1,enableColumnMenu:!1,allowCellFocus:!1,enableColumnMoving:!1};switch(b.state.edit){case!0:n.width=30;break;case!1:n.width=1}g.splice(0,0,n),b.gridOptions.superColDefs.length>0?b.gridOptions.columnDefs=l.sortByFeatureGroup(g,b.gridOptions.superColDefs):b.gridOptions.columnDefs=g}function q(){"false"==k.GetUrlValue("enableExport")&&(b.enableExport=!1),"false"==k.GetUrlValue("enableTitle")&&(b.enableTitle=!1),"false"==k.GetUrlValue("enableShare")&&(b.enableShare=!1),"true"==k.GetUrlValue("deleteAfterLoaded")&&"undefined"!=typeof id&&n.get("/api/remove/"+id),b.state.edit||a.$broadcast("initConfigurator",{features:b.gridOptions.columnDefs,pcmData:b.pcmData})}function r(a,c,d){return n.post("/api/extract-content",{type:"wikipedia",rawContent:a,responseType:"text/plain",transformResponse:function(a,b){return a}}).then(function(a){b.pcmData[c][d]=a.data,b.gridApi.core.notifyDataChange(e.dataChange.COLUMN)},function(e){b.pcmData[c][d]=a}),"Loading value..."}b.height=300,b.minWidth=130,b.enableExport=j.enableExport,b.enableTitle=!0,b.enableShare=j.enableShare,b.file=[],b.FeaturGroupIndex=1,b.gridOptions={headerTemplate:"templates/featureGroupHeader.html",superColDefs:[],columnDefs:[],data:"pcmData",enableRowSelection:!1,showColumnFooter:!0,enableRowHeaderSelection:!1,flatEntityAccess:!0,enableColumnResizing:!0,enableFiltering:!0,enableCellSelection:!1,enableCellEdit:!1,headerRowHeight:60,rowHeight:35},b.columnMovedFunctions=[],b.beginCellEditFunctions=[],b.afterCellEditFunctions=[],b.onNavigateFunctions=[],b.loading=!1;var s,t;$("#img").change(function(){o(this)}),b.putRawDataInCell=function(a,c){b.pcmData[b.pcmData.indexOf(a)][c.name]=b.pcmDataRaw[b.pcmData.indexOf(a)][c.name]},b.setVisualRepresentation=function(a,c,d,e,f){if(d&&f!=d){if(b.state.saved=!1,b.pcmData[b.pcmData.indexOf(a)][c.name]=r(d,b.pcmData.indexOf(a),c.name),"Product"!=c.name)var g=[a.$$hashKey,c.name,f,d];else var g=[a.$$hashKey,"name",f,d];b.newCommand("edit",g)}else b.pcmData[b.pcmData.indexOf(a)][c.name]=e;b.pcmDataRaw[b.pcmData.indexOf(a)][c.name]=d},b.moveColumnData=function(a,c,d){b.gridOptions.columnDefs.move(c,d);var e=[c,d];b.newCommand("move",e),b.state.saved=!1},b.columnMovedFunctions.push(b.moveColumnData),b.beginCellEditFunctions.push(b.putRawDataInCell),b.afterCellEditFunctions.push(b.setVisualRepresentation),b.gridOptions.onRegisterApi=function(a){b.gridApi=a,a.colMovable.on.columnPositionChanged(b,function(a,c,d){for(var e=0;e<b.columnMovedFunctions.length;e++)b.columnMovedFunctions[e]()}),a.edit.on.beginCellEdit(b,function(a,c){for(var d=0;d<b.beginCellEditFunctions.length;d++)b.beginCellEditFunctions[d](a,c,s,t)}),a.edit.on.afterCellEdit(b,function(a,c,d,e){for(var f=0;f<b.pcmData.length;f++)if(b.pcmData[f].$$hashKey==a.$$hashKey)var g=b.pcmDataRaw[f][c.name];for(var f=0;f<b.afterCellEditFunctions.length;f++)b.afterCellEditFunctions[f](a,c,d,e,g)}),a.cellNav.on.navigate(b,function(a,c){for(var d=0;d<b.onNavigateFunctions.length;d++)b.onNavigateFunctions[d](a,c);for(var e=h.expandNavigateFunctions().navigateFunctions,d=0;d<e.length;d++)e[d](a,c)}),a.colResizable.on.columnSizeChanged(b,function(a,c){b.resizeFeatureGroup(b.gridOptions.columnDefs,a,c)})},b.setGridHeight=function(){b.pcmData&&(28*b.pcmData.length+90>2*$(window).height()/3&&!b.enableEdit?b.height=2*$(window).height()/3:28*b.pcmData.length+90>$(window).height()?b.height=$(window).height():b.height=28*b.pcmData.length+90)},b.newColumnDef=function(c,d,f){if(f||(f="string"),d)var g=d;else g="empltyFeatureGroup";var h=k.convertStringToEditorFormat(c),j={name:h,displayName:c,width:"*",enableSorting:!0,enableHiding:!1,enableFiltering:!0,enableColumnResizing:!0,enableColumnMoving:!1,enablePinning:!1,enableCellEdit:b.state.edit,enableCellEditOnFocus:b.state.edit,allowCellFocus:!0,superCol:g,filter:{term:""},minWidth:b.minWidth,cellTemplate:"templates/cellTemplate.html",menuItems:[{title:"Hide",icon:"fa fa-eye-slash",action:function(c){b.gridOptions.columnDefs.forEach(function(a){a.name===h&&(j.visible=!1,b.gridApi.core.notifyDataChange(e.dataChange.COLUMN))}),a.$broadcast("reloadFeatureGroup")}},{title:"Rename Feature",shown:function(){return b.state.edit},icon:"fa fa-pencil",action:function(a){$("#modalRenameFeature").modal("show"),b.oldFeatureName=c,b.featureName=c}},{title:"Change Type",icon:"fa fa-exchange",action:function(a){$("#modalChangeType").modal("show"),b.oldFeatureName=c,b.featureName=c,b.gridOptions.columnDefs.forEach(function(a){a.name===h&&(b.featureType=a.type)})}},{title:"Delete Feature",shown:function(){return b.state.edit},icon:"fa fa-trash-o",action:function(a){b.deleteFeature(h)}},{title:"Unhide everything",icon:"fa fa-eye",action:function(c){b.gridOptions.columnDefs.forEach(function(a){a.visible=!0}),b.gridApi.core.notifyDataChange(e.dataChange.COLUMN),a.$broadcast("reloadFeatureGroup")}}],cellClass:function(a,c,d){var e=b.pcmDataRaw[b.pcmData.indexOf(c.entity)];return b.state.validating&&b.validation[d.name]&&!b.validation[d.name][b.pcmData.indexOf(c.entity)]?"warningCell":e?k.getCellClass(e[d.name],f):void 0},cellTooltip:function(a,c){var d=b.pcmDataRaw[b.pcmData.indexOf(a.entity)],e=b.pcmData[b.pcmData.indexOf(a.entity)];return b.validating&&b.validation[c.name]&&!b.validation[c.name][b.pcmData.indexOf(a.entity)]?"This value doesn't seem to match the feature type.":d&&k.getCellTooltip(d[c.name])?k.getCellTooltip(d[c.name]):e?e[c.name]:void 0}};switch(f){case"string":j.type="string",j.filterHeaderTemplate="<div class='ui-grid-filter-container' ng-show='!grid.appScope.configurator'>   <button class='btn btn-primary mdi-action-search btn-flat btn-sm' style='padding: 4px 6px;' ng-click='grid.appScope.showFilter(col)'>   </button>   <button ng-show='grid.appScope.isFilterOn(col)' class='btn btn-default btn-sm fa fa-close' style='padding:5px' ng-click='grid.appScope.removeFilter(col)'>   </button></div>",j.filter.noTerm=!0,j.filter.condition=function(a,c){return b.filterStringColumns(c,h)},j.footerCellTemplate="<div class='ui-grid-cell-contents'><button class='btn btn-primary fa fa-pie-chart btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInStringPieChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInStringPieChart(col) != 1}' ng-click='grid.appScope.stringPieChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button><button class='btn btn-primary fa fa-connectdevelop btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInStringRadarChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInStringRadarChart(col) != 1}' ng-click='grid.appScope.stringRadarChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button></div>";
break;case"num":j.type="num",j.sortingAlgorithm=function(a,b){var c=parseFloat(a.replace(/\s/g,"").replace(",",".")),d=parseFloat(b.replace(/\s/g,"").replace(",","."));return c-d};var l=[];l.condition=function(a,c){return b.filterLessNumberColumns(c,j,h)},j.filterHeaderTemplate="<div class='ui-grid-filter-container' ng-show='!grid.appScope.configurator'>   <button class='btn btn-primary btn-sm btn-flat mdi-image-tune'  style='padding: 4px 6px;' ng-click='grid.appScope.showFilter(col)' data-toggle='modal' data-target='#modalSlider'>   </button>   <button  ng-show='grid.appScope.isFilterOn(col)' class='btn btn-default btn-sm fa fa-close' style='padding:5px' ng-click='grid.appScope.removeFilter(col)'>   </button></div>";var m=[];m.condition=function(a,c){return b.filterGreaterNumberColumns(c,j,h)},j.filters=[],j.filters.push(m),j.filters.push(l),j.footerCellTemplate="<div class='ui-grid-cell-contents'><button class='btn btn-primary fa fa-line-chart btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInLineChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInLineChart(col) != 1}' ng-click='grid.appScope.lineChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button><button class='btn btn-primary fa fa-bar-chart btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInBarChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInBarChart(col) != 1}' ng-click='grid.appScope.barChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button></div>";break;case"bool":j.type="bool",j.sortingAlgorithm=function(a,b){return"yes"==i.getBooleanValue(a)?1:"no"==i.getBooleanValue(a)?"unknown"==i.getBooleanValue(b)?1:-1:b-a},j.filterHeaderTemplate="<div class='ui-grid-filter-container' ng-show='!grid.appScope.configurator'><button class='btn btn-primary btn-sm' style='padding: 4px 6px;' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isFilterOn(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isFilterOn(col) != 1}' ng-click='grid.appScope.applyBooleanFilter(col, 1)' ><i class='mdi-navigation-check'></i></button><button class='btn btn-danger btn-flat' style='padding: 4px 6px;' ng-class='{\"btn btn-danger btn-sm \" : grid.appScope.isFilterOn(col) == 2, \"btn btn-flat btn-danger btn-sm\": grid.appScope.isFilterOn(col) != 2}' btn-xs' ng-click='grid.appScope.applyBooleanFilter(col, 2)' ><i class='mdi-navigation-close'></i></button></div>",j.filter.noTerm=!0,j.filter.condition=function(a,c){return b.filterBooleanColumns(c,h)},j.footerCellTemplate="<div class='ui-grid-cell-contents'><button class='btn btn-primary fa fa-pie-chart btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInPieChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInPieChart(col) != 1}' ng-click='grid.appScope.pieChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button><button class='btn btn-primary fa fa-connectdevelop btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInRadarChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInRadarChart(col) != 1}' ng-click='grid.appScope.radarChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button></div>";break;case"image":j.type="image",j.enableCellEdit="false;",j.cellTemplate='<form><input ng-show="grid.appScope.edit" type="file" ng-model="grid.appScope.file" ng-change="grid.appScope.uploadFile(col, row)" base-sixty-four-input></form><img height="{{grid.appScope.gridOptions.rowHeight}}px"  ng-src="{{grid.getCellValue(row, col)}}" lazy-src>',j.enableFiltering=!1}return j},b.uploadFile=function(a,c){b.file&&b.pcmData.forEach(function(d){d.$$hashKey==c.entity.$$hashKey&&(d[a.name]="data:image/png;base64,"+b.file.base64)})},b.lineChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("lineChart",{col:c,pcmData:d})},b.barChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("barChart",{col:c,pcmData:d})},b.pieChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("pieChart",{col:c,pcmData:d})},b.radarChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("radarChart",{col:c,pcmData:d})},b.stringPieChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("stringPieChart",{col:c,pcmData:d})},b.stringRadarChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("stringRadarChart",{col:c,pcmData:d})},b.isInLineChart=function(a){return m.isInLineChart(a.name)},b.isInBarChart=function(a){return m.isInBarChart(a.name)},b.isInPieChart=function(a){return m.isInPieChart(a.name)},b.isInRadarChart=function(a){return m.isInRadarChart(a.name)},b.isInStringPieChart=function(a){return m.isInStringPieChart(a.name)},b.isInStringRadarChart=function(a){return m.isInStringRadarChart(a.name)},b.initializeEditor=function(a,c,e,f){e&&(a=g.decodePCM(a)),b.productsKey=a.productsKey.name;var h=g.getConcreteFeatures(a),i=g.getSortedProducts(a,c);b.pcmData=i.map(function(a){var b={};return h.map(function(c){var d=k.convertStringToEditorFormat(c.name);c.name||(d=" ");var e=g.findCell(a,c);b[d]=e.content}),b}),b.pcmDataRaw=i.map(function(a){var b={};return h.map(function(c){var d=k.convertStringToEditorFormat(c.name);c.name||(d=" ");var e=g.findCell(a,c);e.rawContent&&""!=e.rawContent?b[d]=e.rawContent:b[d]=e.content}),b}),p(a,c,h,f),q(),b.setGridHeight(),f&&(b.gridOptions.superColDefs=l.sortFeatureGroupByName(b.gridOptions.superColDefs),d(function(){b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs)},0)),b.state.columnDefs=b.gridOptions.columnDefs,b.state.pcmData=b.pcmData}}]),angular.module("openCompareEditor").controller("FiltersCtrl",["$rootScope","$scope","$timeout","uiGridConstants","editorUtil","chartService","openCompareServer",function(a,b,c,d,e,f,g){function h(a){return"yes"===a.toLowerCase()||"true"===a.toLowerCase()?"yes":"no"===a.toLowerCase()||"false"===a.toLowerCase()?"no":"unknown"}var i;b.columnsFilters=[],b.productFilter="",b.gridOptions2={enableColumnMenus:!1,onRegisterApi:function(a){b.gridApi2=a}},b.slider={options:{range:!0}},b.filterSlider=[],b.removeFilter=function(a){var c=a.colDef.name,e=a.colDef.type;switch(e){case"string":delete b.columnsFilters[c];break;case"num":b.gridOptions.columnDefs.forEach(function(a){a.name==c&&(delete a.filters[0].term,delete a.filters[1].term)}),delete b.columnsFilters[c]}b.gridApi.core.notifyDataChange(d.dataChange.COLUMN)},b.applyBooleanFilter=function(c,e){b.columnsFilters[c.name]==e?b.columnsFilters[c.name]=0:b.columnsFilters[c.name]=e,a.$broadcast("closeCharts",!1),f.initArrays(),b.gridApi.core.notifyDataChange(d.dataChange.COLUMN)},b.applyProductFilter=function(){a.$broadcast("closeCharts",!1),f.initArrays(),b.gridOptions.columnDefs[1].filter.term=b.productFilter},b.isFilterOn=function(a){return b.columnsFilters[a.name]},b.checkFilterSliderMin=function(){b.filterSlider[0]>b.filterSlider[1]&&(b.filterSlider[0]=b.filterSlider[1])},b.checkFilterSliderMax=function(){b.filterSlider[1]<b.filterSlider[0]&&(b.filterSlider[1]=b.filterSlider[0])},b.showFilter=function(a){b.featureToFilter=a.name,b.ListToFilter=[],b.gridOptions2.data=[];var f=a.colDef.type;switch(f){case"string":b.gridApi2.core.notifyDataChange(d.dataChange.COLUMN),b.pcmData.forEach(function(c){-1===b.ListToFilter.indexOf(c[a.name])&&b.ListToFilter.push(c[a.name])}),b.ListToFilter.sort(),c(function(){b.ListToFilter.forEach(function(a){b.gridOptions2.data.push({product:a})})},100),$("#modalStringFilter").modal("show");break;case"num":var g=e.findMinAndMax(b.featureToFilter,b.pcmData);b.slider.options.min=g[0],b.slider.options.max=g[1],b.filterSlider[0]=g[0],b.filterSlider[1]=g[1],g[1]<10?b.slider.options.step=.1:g[1]>1e3?b.slider.options.step=10:b.slider.options.step=1}},b.closeFilter=function(){var c=b.featureToFilter,g=e.convertStringToEditorFormat(c),h="";switch(b.gridOptions.columnDefs.forEach(function(a){a.name==c&&(h=a.type)}),h){case"string":var j=b.gridApi2.selection.getSelectedRows();0==j.length&&b.gridOptions2.data.forEach(function(a){j.push(a)}),b.colFilter=[],b.colFilter.listTerm=[],j.forEach(function(a){b.colFilter.listTerm.push(a.product)}),b.columnsFilters[g]=[],b.columnsFilters[g]=b.colFilter.listTerm,b.gridApi.core.notifyDataChange(d.dataChange.COLUMN);break;case"num":b.gridOptions.columnDefs.forEach(function(a){a.name==g&&(a.filters[0].term=b.filterSlider[0],a.filters[1].term=b.filterSlider[1]+1)}),b.columnsFilters[g]=[]}i&&i.remove(),a.$broadcast("closeCharts",!1),f.initArrays()},b.filterStringColumns=function(a,c){if(b.columnsFilters[c]){for(var d=!1,f=0;!d&&f<b.columnsFilters[c].length;)(a==b.columnsFilters[c][f]||e.isEmptyCell(a))&&(d=!0),f++;return d}return!0},b.filterLessNumberColumns=function(a,c,d){return b.columnsFilters[d]?parseFloat(a.replace(/\s/g,"").replace(",","."))>=c.filters[0].term||e.isEmptyCell(a):!0},b.filterGreaterNumberColumns=function(a,c,d){return b.columnsFilters[d]?parseFloat(a.replace(/\s/g,"").replace(",","."))<=c.filters[1].term||e.isEmptyCell(a):!0},b.filterBooleanColumns=function(a,c){return 1==b.columnsFilters[c]?"yes"==h(a):2==b.columnsFilters[c]?"no"==h(a)||e.isEmptyCell(a):!0},b.$on("updateFilterFromConfigurator",function(a,c){switch(c.type){case"string":c.values.length>0?b.columnsFilters[c.feature]=c.values:delete b.columnsFilters[c.feature];break;case"bool":1==c.values?b.columnsFilters[c.feature]=1:delete b.columnsFilters[c.feature];break;case"num":b.columnsFilters[c.feature]=[],b.gridOptions.columnDefs.forEach(function(a){a.name==c.feature&&(a.filters[0].term=c.values[0],a.filters[1].term=c.values[1])})}b.gridApi.core.notifyDataChange(d.dataChange.COLUMN)})}]),angular.module("openCompareEditor").controller("TypesCtrl",["$rootScope","$scope","$timeout","uiGridConstants","$compile","$modal","typeService",function(a,b,c,d,e,f,g){b.featureType="string",b.validation=[],b.validating=!1,b.$watch("state.validating",function(a){if(a){if(b.pcmData.length>0){var c=[],e=0;b.gridOptions.columnDefs.forEach(function(a){" "!=a.name&&"Product"!=a.name&&(b.validation[a.name]=[],c[e]=a.name,e++)}),e=0,b.pcmData.forEach(function(a){for(var d=0;d<c.length;d++){var f=c[d];if(" "!=f){var h="";b.gridOptions.columnDefs.forEach(function(a){a.name==f&&(h=a.type)}),b.validation[f][e]=g.validateType(a[f],h)}}e++})}b.gridApi.core.notifyDataChange(d.dataChange.COLUMN)}})}]),angular.module("openCompareEditor").controller("FeatureGroupCtrl",["$rootScope","$scope","$window","$timeout","featureGroupService","editorUtil","$modal",function(a,b,c,d,e,f,g){b.isAFeature=function(a){return" "!=a.name&&"Product"!=a.name},b.isAFeatureGroup=function(a){return"emptyFeatureGroup"!=a.name},b.setCols=function(){console.log(b.gridOptions);for(var a=b.gridOptions.columnDefs,c=2;c<a.length;c++)b.cols[c-2]={name:a[c].name,isChecked:!1}},b.setFeatureGroupModal=function(a){b.currentFeatureGroup=a,console.log(b.currentFeatureGroup)},b.openAssignFeatureGroupModal=function(a,c){b.cols=c,b.currentFeatureGroup=a,b.$modalInstance=g.open({templateUrl:"templates/modal/modalAssignFeatureGroup.html",scope:b,controller:"FeatureGroupCtrl"})},b.openRenameFeatureGroupModal=function(a){b.newFeatureGroup=a,b.currentFeatureGroup=a,b.$modalInstance=g.open({templateUrl:"templates/modal/modalRenameFeatureGroup.html",scope:b,controller:"FeatureGroupCtrl"})},b.deleteUnusedFeatureGroups=function(){var a=0;for(var c in b.gridOptions.superColDefs)b.gridOptions.superColDefs[a]&&(0==f.getNumberOfFeaturesWithThisFeatureGroup(b.gridOptions.columnDefs,b.gridOptions.superColDefs[a].name)&&b.gridOptions.superColDefs.splice(a,1),a++)},b.loadFeatureGroups=function(c,e){var g=b.minWidth,h=$(document).width()-150-30-3;if(h>(c.length-2)*b.minWidth)d(function(){a.$broadcast("reloadFeatureGroup")},100);else for(var i=0;i<e.length;i++){var j=e[i].name,k=jQuery('.ui-grid-header-cell[col-name="'+j+'"]'),l=f.getNumberOfFeaturesWithThisFeatureGroup(c,e[i].name),m=l*g;k.css({"min-width":m+"px","max-width":m+"px","text-align":"center"})}},b.resizeFeatureGroup=function(c,e,g){var h=$(document).width()-150-30-3;if(h>(c.length-2)*b.minWidth)d(function(){a.$broadcast("reloadFeatureGroup")},100);else{var i=jQuery('.ui-grid-header-cell[col-name="'+e.superCol+'"]'),j=i.outerWidth()+g;if(0>g){var k=f.getNumberOfFeaturesWithThisFeatureGroup(c,e.superCol);j<k*e.minWidth&&(j=k*e.minWidth)}i.css({"min-width":j+"px","max-width":j+"px","text-align":"center"})}},b.adaptFeatureGroupsWidthsToHeaderRow=function(a){var b=30/a.length;console.log(b);for(var c=0;c<a.length;c++){var d=a[c].name;if("emptyFeatureGroup"!=d){var e=jQuery('.ui-grid-header-cell[col-name="'+d+'"]'),f=e.outerWidth()-b;e.css({"min-width":f+"px","max-width":f+"px","text-align":"center"})}}},b.getFeaturesWithThisFeatureGroup=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.superCol==a&&c.push(e.name)}return c},b.isAFeatureWithThisFeatureGroup=function(a,b){return a.superCol==b},b.assignFeatureGroup=function(c,d){b.$modalInstance.close(),a.$broadcast("assignFeatureGroup",{featureGroup:c,features:d})},b.renameFeatureGroup=function(c,d){b.$modalInstance.close(),a.$broadcast("renameFeatureGroup",{oldFeatureGroup:c,newFeatureGroup:d})},b.cancelModal=function(){b.$modalInstance.close()},b.$watch(function(){return c.innerWidth},function(b){a.$broadcast("reloadFeatureGroup")})}]),angular.module("openCompareEditor").service("openCompareServer",["$http","$q",function(a,b){function c(c,e,i,j){if(g!==d){var k=e;return g===f&&(k=h+e),"get"===c?a.get(k,j):a.post(k,i,j)}var l=b.defer();return l.reject("Cannot request server in client mode."),l.promise}var d="client",e="local",f="remote",g=d,h="";this.useClient=function(){g=d},this.useLocalServer=function(){g=e},this.useRemoteServer=function(a){g=f,h=a},this.get=function(a,b,d){return c("get",a,b,d)},this.post=function(a,b,d){return c("post",a,b,d)}}]),angular.module("openCompareEditor").service("expandeditor",function(){var a=[];this.expandAfterCellEdit=function(b){return{afterCellEditFunctions:a,addFunction:function(){a.push(b)}}};var b=[];this.expandBeginCellEdit=function(a){return{beginCellEditFunctions:b,addFunction:function(){b.push(a)}}};var c=[];this.expandColumnsMoved=function(a){return{columnMovedFunctions:c,addFunction:function(){c.push(a)}}};var d=[];this.expandNavigateFunctions=function(a){return{navigateFunctions:d,addFunction:function(){d.push(a)}}}}),angular.module("openCompareEditor").service("pcmApi",["base64",function(a){var b=Kotlin.modules["org.opencompare.model.pcm"].org.opencompare.model.pcm;this.factory=new b.factory.DefaultPcmFactory;var c=this.factory.createJSONLoader(),d=this.factory.createJSONSerializer(),e=this;e.sortByName=function(a,b){return a.name<b.name?-1:a.name>b.name?1:0},e.createFeature=function(a,b,c){var d=c.createFeature();d.name=a,b.addFeatures(d);for(var e=0;e<b.products.array.length;e++){var f=c.createCell();f.content="",f.feature=d,b.products.array[e].addValues(f)}return d},e.getConcreteFeatures=function(a){function b(a){var c=[];if("undefined"!=typeof a.subFeatures)for(var d=a.subFeatures.array,e=0;e<d.length;e++){var f=d[e];c=c.concat(b(f))}else c.push(a);return c}var c=[];if("undefined"!=typeof a.features)for(var d=a.features.array,e=0;e<d.length;e++){var f=d[e];c=c.concat(b(f))}return c},e.findCell=function(a,b){for(var c=a.cells.array,d=0;d<c.length;d++){var e=c[d];if(e.feature.name===b.name)return e}},e.encodePCM=function(a){return this.base64PCMVisitor(a,!0),a},e.decodePCM=function(a){return this.base64PCMVisitor(a,!1),a},e.base64PCMVisitor=function(b,c){function d(b,c){return c?a.encode(b):a.decode(b)}function e(a,b){a.name=d(a.name,b),"undefined"!=typeof a.subFeatures&&a.subFeatures.array.forEach(function(a){e(a,b)})}b.name=d(b.name,c),b.features.array.forEach(function(a){e(a,c)}),b.products.array.forEach(function(a){a.cells.array.forEach(function(a){a.content=d(a.content,c),a.rawContent=d(a.rawContent,c)})})},e.loadPCMModelFromString=function(a){return c.loadModelFromString(a).get(0)},e.serializePCM=function(a){return d.serialize(a)},e.getSortedProducts=function(a,b){function c(c){for(var d=0,f=0;f<b.productPositions.length;f++){var g=e.findCell(c,a.productsKey).content;if(b.productPositions[f].product===g){d=b.productPositions[f].position;break}}return d}return b?a.products.array.sort(function(a,b){var d=c(a),e=c(b);return d-e}):a.products.array}}]),angular.module("openCompareEditor").service("editorOptions",["$rootScope",function(a){this.initialize=function(b){a.$broadcast("initializeFromExternalSource",b)},this.initializeFromArray=function(b){a.$broadcast("initializeFromArray",b)};var b=!0;this.enableExport=function(a){return{get:b,set:function(){b=a}}};var c=!0;this.enableShare=function(a){return{get:c,set:function(){c=a}}};var d=!0;this.setEdit=function(a){return{get:d,set:function(){d=a}}}}]),angular.module("openCompareEditor").service("sortFeaturesService",function(){function a(a,b){return a.superCol&&b.superCol?"emptyFeatureGroup"==a.superCol?1:"emptyFeatureGroup"==b.superCol?-1:a.superCol<b.superCol?-1:a.superCol>b.superCol?1:0:-1}function b(a,b){return"emptyFeatureGroup"==a.name?1:"emptyFeatureGroup"==b.name?-1:a.name<b.name?-1:a.name>b.name?1:0}this.sortByType=function(a,b){for(var c=[],d=0,e=0,f=0,g=0;g<a.length;g++){var h=a[g];switch(b[h.name]){case"string":c.splice(d,0,h),e++,f++;break;case"number":c.splice(e+1,0,h),f++;break;case"boolean":c.splice(f,0,h)}}return c},this.sortByFeatureGroup=function(b){var c=b.slice(2,b.length);return c.sort(a),c.unshift(b[1]),c.unshift(b[0]),c},this.sortFeatureGroupByName=function(a){return a.sort(b),a}}),angular.module("openCompareEditor").service("featureGroupService",function(){var a="";this.setCurrentFeatureGroup=function(b){a=b},this.getCurrentFeatureGroup=function(){return a}}),angular.module("openCompareEditor").service("editorUtil",["$rootScope",function(a){this.getCellClass=function(a,b){return a&&"bool"==b?-1!=a.toLowerCase().indexOf("yes")||-1!=a.toLowerCase().indexOf("oui")?"yesCell":-1!=a.toLowerCase().indexOf("dunno")||-1==a.toLowerCase().indexOf("no")&&-1==a.toLowerCase().indexOf("non")?!1:"noCell":!1},this.getFeaturesFromArray=function(a){var b=[];return a.forEach(function(a){for(var c in a)-1==b.indexOf(c)&&"$$hashKey"!=c&&b.push(c)}),b},this.getCellTooltip=function(a){if(a){if(-1!=a.toLowerCase().indexOf("<ref")){var b=a.toLowerCase().indexOf("<ref"),c=a.substring(b+11),d=c.replace(/\s/g,"").indexOf('"/>');return c.substring(0,d)}if(-1!=a.toLowerCase().indexOf("<ref>{{")){var b=a.toLowerCase().indexOf("<ref>{{"),c=a.substring(b+11),d=c.replace(/\s/g,"").indexOf("}}</ref>");return c.substring(0,d)}if(-1!=a.toLowerCase().indexOf("<ref>{{")){var b=a.toLowerCase().indexOf("<ref>{{"),c=a.substring(b+11),d=c.replace(/\s/g,"").indexOf("}}</ref>");return c.substring(0,d)}return!1}return!1},this.convertStringToEditorFormat=function(a){return a.replace(/\(/g,"%28").replace(/\)/g,"%29")},this.convertStringToPCMFormat=function(a){return a.replace(/%28/g,"(").replace(/%29/g,")")},this.sortFeatures=function(a,b,c){function d(b){var d=-1;return c.forEach(function(c){var e="";a.forEach(function(a){a.generated_KMF_ID===c.feature&&(e=a.name)}),e===b&&(d=c.position)}),d}var e=b.sort(function(a,b){var c=d(a.name),e=d(b.name);return-1==c?1:-1==e?-1:c-e});return e},this.findMinAndMax=function(a,b){var c=0,d=0;return b.forEach(function(b){parseInt(b[a])>d&&(d=parseFloat(b[a].replace(/\s/g,"").replace(",","."))),parseInt(b[a])<c&&(c=parseFloat(b[a].replace(/\s/g,"").replace(",",".")))}),[c,d]},this.isEmptyCell=function(a){return!a.toLowerCase()||""==a.toLowerCase()||"N/A"==a.toLowerCase()||"?"==a.toLowerCase()||"unknown"==a.toLowerCase()},this.checkIfNameExists=function(a,b){var c="";c=a?a:"New Feature";var d=0;return b.forEach(function(a){var b=a.name.replace(/[0-9]/g,"");b===c&&d++}),0!=d&&(c+=d),c},this.GetUrlValue=function(a){for(var b=document.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]==a)return e[1]}},this.getNumberOfFeaturesWithThisFeatureGroup=function(a,b){for(var c=0,d=0;d<a.length;d++)a[d].superCol==b&&c++;return c},this.goToCell=function(b,c){a.$broadcast("goToCell",{row:b,col:c})}}]),angular.module("openCompareEditor").service("typeService",["editorUtil",function(a){this.getType=function(b,c){for(var d=0,e=0,f=0,g=0,h=0,i=a.convertStringToEditorFormat(b);c[d];)c[d][i]&&(this.isABase64Image(c[d][i])&&e++,angular.equals(parseInt(c[d][i]),NaN)?this.isBooleanValue(c[d][i])?g++:a.isEmptyCell(c[d][i])||h++:f++),d++;var j="",k=Math.max(e,f,g,h);return j=0==k?"string":e==k?"image":f==k?"num":g==k?"bool":"string"},this.validateType=function(b,c){var d="";return d=angular.equals(parseInt(b),NaN)?this.isBooleanValue(b)?"bool":a.isEmptyCell(b)?"none":"string":"num","none"==d?!0:"string"==c?!0:d===c},this.isBooleanValue=function(a){return"yes"===a.toLowerCase()||"true"===a.toLowerCase()||"no"===a.toLowerCase()||"false"===a.toLowerCase()},this.getBooleanValue=function(a){return"yes"===a.toLowerCase()||"true"===a.toLowerCase()?"yes":"no"===a.toLowerCase()||"false"===a.toLowerCase()?"no":"unknown"},this.isABase64Image=function(a){return-1!=a.indexOf("data:image/png;base64,")}}]),angular.module("openCompareEditor").service("chartService",["editorUtil",function(a){this.initArrays=function(){b=[],c=[],d=[],e=[],f=[],g=[]};var b=[];this.addInLineChart=function(c){c=a.convertStringToPCMFormat(c),b.push(c)},this.removeFromLineChart=function(c){c=a.convertStringToPCMFormat(c);var d=b.indexOf(c);b.splice(d,1)},this.isInLineChart=function(c){c=a.convertStringToPCMFormat(c);var d=b.indexOf(c);return-1!=d};var c=[];this.addInBarChart=function(b){b=a.convertStringToPCMFormat(b),c.push(b)},this.removeFromBarChart=function(b){b=a.convertStringToPCMFormat(b);var d=c.indexOf(b);c.splice(d,1)},this.isInBarChart=function(b){b=a.convertStringToPCMFormat(b);var d=c.indexOf(b);return-1!=d};var d=[];this.addInPieChart=function(b){b=a.convertStringToPCMFormat(b),d.splice(0,1,b)},this.removeFromPieChart=function(b){b=a.convertStringToPCMFormat(b);var c=d.indexOf(b);d.splice(c,1)},this.isInPieChart=function(b){b=a.convertStringToPCMFormat(b);var c=d.indexOf(b);return-1!=c};var e=[];this.addInRadarChart=function(b){b=a.convertStringToPCMFormat(b),e.push(b)},this.removeFromRadarChart=function(b){b=a.convertStringToPCMFormat(b);var c=e.indexOf(b);e.splice(c,1)},this.isInRadarChart=function(b){b=a.convertStringToPCMFormat(b);var c=e.indexOf(b);return-1!=c};var f=[];this.addInStringPieChart=function(b){b=a.convertStringToPCMFormat(b),f.splice(0,1,b)},this.removeFromStringPieChart=function(b){b=a.convertStringToPCMFormat(b);var c=f.indexOf(b);f.splice(c,1)},this.isInStringPieChart=function(b){b=a.convertStringToPCMFormat(b);var c=f.indexOf(b);return-1!=c};var g=[];this.addInStringRadarChart=function(b){b=a.convertStringToPCMFormat(b),g.splice(0,1,b)},this.removeFromStringRadarChart=function(b){b=a.convertStringToPCMFormat(b);var c=g.indexOf(b);g.splice(c,1)},this.isInStringRadarChart=function(b){b=a.convertStringToPCMFormat(b);var c=g.indexOf(b);return-1!=c}}]),angular.module("openCompareEditor").controller("ChartsCtrl",["$rootScope","$scope","chartService","typeService","editorUtil","pcmApi",function(a,b,c,d,e,f){b.showChartPanel=!1,b.showLineChart=!1,b.showBarChart=!1,b.showPieChart=!1,b.showRadarChart=!1,b.showStringPieChart=!1,b.showStringRadarChart=!1,$("#chartPanel").draggable(),$("#chartPanel").resizable({aspectRatio:4/3,minHeight:600}),$("#chartPanel").on("resize",function(b,c){a.$broadcast("closeCharts")}),b.closeCharts=function(a){a&&(b.showChartPanel=!1),b.showLineChart=!1,b.showBarChart=!1,b.showPieChart=!1,b.showRadarChart=!1,b.showStringPieChart=!1,b.showStringRadarChart=!1,c.initArrays(),b.pieSeries=[],b.radarSeries=[],b.stringPieSeries=[],b.stringRadarSeries=[]},b.$on("closeCharts",function(a,c){b.closeCharts(c)}),b.lineLabels=[],b.lineSeries=[],b.lineData=[],b.$on("lineChart",function(a,d){b.showChartPanel=!0,$("#lineTab").tab("show");var f=e.convertStringToPCMFormat(d.col.name),g=[];if(d.pcmData.forEach(function(a){g.push(a.entity)}),b.showLineChart){var h=b.lineSeries.indexOf(f);if(-1!=h)b.lineSeries.splice(h,1),c.removeFromLineChart(f),b.lineData.splice(h,1),0==b.lineSeries.length&&(b.showLineChart=!1,b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart);else{var i=[];g.forEach(function(a){i.push(parseInt(a[f])||0)}),b.lineData.push(i),b.lineSeries.push(f),c.addInLineChart(f)}}else{b.showLineChart=!0,b.lineSeries=[f],c.addInLineChart(f);var i=[],j=[],k=b.productsKey;g.forEach(function(a){j.push(a[k.name]),i.push(parseInt(a[f])||0)}),b.lineData=[i],b.lineLabels=j}}),b.isInLineChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.lineSeries.indexOf(c);return-1!=d},b.barLabels=[],b.barSeries=[],b.barData=[],b.$on("barChart",function(a,d){b.showChartPanel=!0,$("#barTab").tab("show");var f=e.convertStringToPCMFormat(d.col.name),g=[];if(d.pcmData.forEach(function(a){g.push(a.entity)}),b.showBarChart){var h=b.barSeries.indexOf(f);if(-1!=h)b.barSeries.splice(h,1),c.removeFromBarChart(f),b.barData.splice(h,1),0==b.barSeries.length&&(b.showBarChart=!1,b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart);else{var i=[];g.forEach(function(a){i.push(parseInt(a[f])||0)}),b.barData.push(i),b.barSeries.push(f),c.addInBarChart(f)}}else{b.showBarChart=!0,b.barSeries=[f],c.addInBarChart(f);var i=[],j=[],k=b.productsKey;g.forEach(function(a){j.push(a[k.name]),i.push(parseInt(a[f])||0)}),b.barData=[i],b.barLabels=j}}),b.isInBarChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.barSeries.indexOf(c);return-1!=d},b.pieLabels=[],b.pieSeries=[],b.pieData=[],b.$on("pieChart",function(a,f){b.showChartPanel=!0,$("#pieTab").tab("show");var g=e.convertStringToPCMFormat(f.col.name),h=[];if(f.pcmData.forEach(function(a){h.push(a.entity)}),b.colors=["#B2FF59","#FF5722","#DCDCDC"],b.showPieChart){var i=b.pieSeries.indexOf(g);if(-1!=i)b.showPieChart=!1,b.pieSeries=[],c.removeFromPieChart(g),b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart;else{var j=[0,0,0];h.forEach(function(a){switch(d.getBooleanValue(a[g])){case"yes":j[0]++;break;case"no":j[1]++;break;case"unknown":j[2]++}}),b.pieData=j,b.pieSeries=[g],c.addInPieChart(g)}}else{b.showPieChart=!0,b.pieSeries=[g],c.addInPieChart(g);var j=[0,0,0],k=["Yes","No","Unknown"];h.forEach(function(a){switch(d.getBooleanValue(a[g])){case"yes":j[0]++;break;case"no":j[1]++;break;case"unknown":j[2]++}}),b.pieData=j,b.pieLabels=k}}),b.isInPieChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.pieSeries.indexOf(c);return-1!=d},b.radarLabels=[],b.radarSeries=[],b.radarData=[],b.$on("radarChart",function(a,f){b.showChartPanel=!0,$("#radarTab").tab("show");var g=e.convertStringToPCMFormat(f.col.name),h=[];if(f.pcmData.forEach(function(a){h.push(a.entity)}),b.showRadarChart){var i=b.radarSeries.indexOf(g);if(-1!=i)b.radarSeries.splice(i,1),c.removeFromRadarChart(g),b.radarData.splice(i,1),0==b.radarSeries.length&&(b.showRadarChart=!1,b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart);else{var j=[0,0,0];h.forEach(function(a){switch(d.getBooleanValue(a[g])){case"yes":j[0]++;break;case"no":j[1]++;break;case"unknown":j[2]++}}),b.radarData.push(j),b.radarSeries.push(g),c.addInRadarChart(g)}}else{b.showRadarChart=!0,b.radarSeries=[g],c.addInRadarChart(g);var j=[0,0,0],k=["Yes","No","Unknown"];h.forEach(function(a){switch(d.getBooleanValue(a[g])){case"yes":j[0]++;break;case"no":j[1]++;break;case"unknown":j[2]++}}),b.radarData=[j],b.radarLabels=k}}),b.isInRadarChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.radarSeries.indexOf(c);return-1!=d},b.stringPieLabels=[],b.stringPieSeries=[],b.stringPieData=[],b.$on("stringPieChart",function(a,d){b.showChartPanel=!0,$("#stringPieTab").tab("show");var f=e.convertStringToPCMFormat(d.col.name),g=[];if(d.pcmData.forEach(function(a){g.push(a.entity)}),b.showStringPieChart){var h=b.stringPieSeries.indexOf(f);if(-1!=h)b.showStringPieChart=!1,b.stringPieSeries=[],c.removeFromStringPieChart(f),b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart;else{var i=[],j=[];g.forEach(function(a){var b=a[f],c=j.indexOf(b);-1==c?(j.push(b),i.push(1)):i[c]++}),b.stringPieData=i,b.stringPieLabels=j,b.stringPieSeries=[f],c.addInStringPieChart(f)}}else{b.showStringPieChart=!0,b.stringPieSeries=[f],c.addInStringPieChart(f);var i=[],j=[];g.forEach(function(a){var b=a[f],c=j.indexOf(b);-1==c?(j.push(b),i.push(1)):i[c]++}),b.stringPieData=i,b.stringPieLabels=j}}),b.stringRadarLabels=[],b.stringRadarSeries=[],b.stringRadarData=[],b.$on("stringRadarChart",function(a,d){b.showChartPanel=!0,$("#stringRadarTab").tab("show");var f=e.convertStringToPCMFormat(d.col.name),g=[];if(d.pcmData.forEach(function(a){g.push(a.entity)}),b.showStringRadarChart){var h=b.stringRadarSeries.indexOf(f);if(-1!=h)b.showStringRadarChart=!1,b.stringRadarSeries=[],c.removeFromStringRadarChart(f),b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart;else{var i=[],j=[];g.forEach(function(a){var b=a[f],c=j.indexOf(b);-1==c?(j.push(b),i.push(1)):i[c]++}),b.stringRadarData=[i],b.stringRadarLabels=j,b.stringRadarSeries=[f],c.addInStringRadarChart(f)}}else{b.showStringRadarChart=!0,b.stringRadarSeries=[f],c.addInStringRadarChart(f);var i=[],j=[];g.forEach(function(a){var b=a[f],c=j.indexOf(b);-1==c?(j.push(b),i.push(1)):i[c]++}),b.stringRadarData=[i],b.stringRadarLabels=j}}),b.isInStringRadarChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.stringRadarSeries.indexOf(c);return-1!=d}}]),angular.module("openCompareEditor").directive("ocCharts",function(){return{restrict:"E",require:"^ocEditor",scope:{},templateUrl:"charts/charts.html",controller:"ChartsCtrl",link:function(a,b,c,d){a.pcmContainer=d.pcmContainer,a.$watchCollection("pcmContainer",function(b){"undefined"!=typeof b&&(a.pcmContainer=d.pcmContainer,a.pcm=d.pcmContainer.pcm,"undefined"!=typeof a.pcm&&(a.productsKey=d.pcmContainer.pcm.productsKey),a.metadata=d.pcmContainer.metadata,a.id=d.pcmContainer.id)}),a.config=d.config,a.state=d.state}}}),angular.module("openCompareEditor").controller("ConfiguratorCtrl",["$rootScope","$scope","editorUtil","typeService",function(a,b,c,d){b.data=[],b.currentPage=0,b.pageSize=5,b.limit={},b.productFilter="",b.booleanFeatures=[],b.stringFeatures=[],b.numberFeatures=[],b.booleanFilteredFeatures=[],b.stringFilteredFeatures=[],b.slider=[],b.numberOfPages=function(){return b.length=0,b.data.length>0&&b.data.forEach(function(a){b.isInFilter(a)&&b.length++}),Math.ceil(b.length/b.pageSize)},b.setLineView=function(a){b.state.lineView=a},b.$watch("state.configurator",function(a){if(a){b.booleanFeatures=[],b.stringFeatures=[],b.numberFeatures=[],b.booleanFilteredFeatures=[],b.stringFilteredFeatures=[],b.slider=[];var d=b.state.columnDefs;b.data=b.state.pcmData,d.forEach(function(a){switch(a.type){case"string":b.stringFeatures.push(a);break;case"bool":b.booleanFeatures.push(a);break;case"num":b.numberFeatures.push(a);var d=c.findMinAndMax(a.name,b.data);b.slider[a.name]={},b.slider[a.name].values=d,b.slider[a.name].options={range:!0,min:d[0],max:d[1],change:function(c,d){b.state.configurator&&b.$emit("updateFilterFromConfigurator",{feature:a.name,type:"num",values:b.slider[a.name].values})}}}})}}),b.getUniqueValues=function(a){var c=[];return b.data.forEach(function(b){var d=b[a],e=c.indexOf(d);-1==e&&c.push(d)}),c},b.hasThisFeature=function(a){return"yes"==d.getBooleanValue(a)},b.updateFilterWithThisFeature=function(a,c,d){switch(c){case"bool":b.booleanFilteredFeatures[a]?delete b.booleanFilteredFeatures[a]:b.booleanFilteredFeatures[a]=!0,
b.$emit("updateFilterFromConfigurator",{feature:a,type:"bool",values:b.booleanFilteredFeatures[a]});break;case"string":if(b.stringFilteredFeatures[a]){var e=b.stringFilteredFeatures[a].indexOf(d);-1==e?b.stringFilteredFeatures[a].push(d):b.stringFilteredFeatures[a].splice(e,1)}else b.stringFilteredFeatures[a]=[],b.stringFilteredFeatures[a].push(d);b.$emit("updateFilterFromConfigurator",{feature:a,type:"string",values:b.stringFilteredFeatures[a]})}b.currentPage=0},b.isInFilter=function(a){if(b.productFilter&&-1==a[b.productsKey.name].toLowerCase().indexOf(b.productFilter.toLowerCase()))return!1;for(var c in b.booleanFilteredFeatures)if("move"!=c&&"yes"!=d.getBooleanValue(a[c]))return!1;for(var c in b.stringFilteredFeatures)if("move"!=c&&b.stringFilteredFeatures[c].length>0&&-1==b.stringFilteredFeatures[c].indexOf(a[c]))return!1;for(var c in b.slider)if(b.slider[c].values&&(parseFloat(a[c].replace(/\s/g,"").replace(",","."))<b.slider[c].values[0]||parseFloat(a[c].replace(/\s/g,"").replace(",","."))>b.slider[c].values[1]))return!1;return!0},b.collapseAll=function(){b.collapseAll=!0,b.limit["boolean"]=0,b.limit.forEach(function(a){b.limit[a]=0})}}]).filter("startFrom",function(){return function(a,b){return b=+b,"undefined"!=typeof a&&a.length>0?a.slice(b):{}}}),angular.module("openCompareEditor").directive("ocConfigurator",["componentUtils",function(a){return{restrict:"E",require:"^ocEditor",scope:{},templateUrl:"configurator/configurator.html",controller:"ConfiguratorCtrl",link:function(b,c,d,e){b.pcmContainer=e.pcmContainer,b.$watchCollection("pcmContainer",function(a){"undefined"!=typeof a&&(b.pcmContainer=e.pcmContainer,b.pcm=e.pcmContainer.pcm,"undefined"!=typeof b.pcm&&(b.productsKey=e.pcmContainer.pcm.productsKey),b.metadata=e.pcmContainer.metadata,b.id=e.pcmContainer.id)}),b.config=e.config,b.state=e.state,a.defineOption(b.state,["configurator"],!1),a.defineOption(b.state,["lineView"],!0)}}}]),angular.module("openCompareEditor").directive("fileModel",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.fileModel),f=e.assign;c.bind("change",function(){b.$apply(function(){f(b,c[0].files[0])})})}}}]),angular.module("openCompareEditor").controller("CreatorCtrl",["$rootScope","$scope","$document","pcmApi",function(a,b,c,d){b.title="",b.rows=1,b.columns=1,b.loading=!1,b.launchCreation=function(){var a,c,e={};b.state.edit=!0;var f=d.factory.createPCM();f.name=b.title;var g={};for(g.featurePositions=[],c=0;c<b.columns+1;c++){var h=d.factory.createFeature();0==c?(h.name="Products",f.productsKey=h):h.name="Feature "+c,f.addFeatures(h),e[h.name]=h,g.featurePositions.push({feature:h.name,position:c})}for(g.productPositions=[],a=0;a<b.rows;a++){var i=d.factory.createProduct();f.addProducts(i);var j;for(c=0;c<b.columns+1;c++){var k=d.factory.createCell();0==c?(j="Product "+(a+1),k.content=j,k.feature=e.Products):(k.content="",k.feature=e["Feature "+c]),i.addCells(k)}g.productPositions.push({product:j,position:a})}b.pcmContainer.pcm=f,b.pcmContainer.metadata=g},c.ready(function(){$("#modalCreator").modal("show")})}]),angular.module("openCompareEditor").directive("ocCreator",["componentUtils",function(a){return{restrict:"E",require:"^ocEditor",scope:{user:"="},templateUrl:"creator/creator.html",controller:"CreatorCtrl",link:function(b,c,d,e){b.pcmContainer=e.pcmContainer,b.$watch("pcmContainer.pcm",function(a){b.pcm=e.pcmContainer.pcm,"undefined"==typeof e.pcmContainer.metadata&&(e.pcmContainer.metadata={}),b.metadata=e.pcmContainer.metadata,b.metadata.creator=b.user,b.id=e.pcmContainer.id}),b.config=e.config,b.state=e.state,a.defineOption(b.state,["edit"],!1)}}}]),angular.module("openCompareEditor").directive("ocCsvImporter",["componentUtils",function(a){return{restrict:"E",require:"^ocEditor",scope:{api:"="},controller:["$scope","$modal",function(a,b){a.api={open:function(){a.modalInstance=b.open({templateUrl:"io/csv/modalCsvImport.html",scope:a,controller:"CsvImportCtrl"})}}}],link:function(a,b,c,d){a.pcmContainer=d.pcmContainer,a.$watchCollection("pcmContainer",function(b){"undefined"!=typeof b&&(a.pcmContainer=d.pcmContainer,a.pcm=d.pcmContainer.pcm,a.metadata=d.pcmContainer.metadata,a.id=d.pcmContainer.id)}),a.config=d.config,a.state=d.state}}}]),angular.module("openCompareEditor").controller("CsvImportCtrl",["$rootScope","$scope","openCompareServer","pcmApi","$modal",function(a,b,c,d,e){b.loading=!1,b.file=null,b.title="",b.productAsLines=!0,b.separator=",",b.quote='"',b.message="",b.valid=function(){var a=new FormData;a.append("file",b.file),a.append("title",b.title),a.append("productAsLines",b.productAsLines),a.append("separator",b.separator),a.append("quote",b.quote),b.message="",b.loading=!0,c.post("/api/import/csv",a,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then(function(a){b.loading=!1;var c=a.data[0];b.pcmContainer.pcm=d.loadPCMModelFromString(JSON.stringify(c.pcm)),d.decodePCM(b.pcmContainer.pcm),b.pcmContainer.metadata=c.metadata,b.modalInstance.close()},function(a){b.loading=!1,b.message=a.data})}}]),angular.module("openCompareEditor").controller("CsvExportCtrl",["$rootScope","$scope","$modal","$modalInstance","openCompareServer",function(a,b,c,d,e){b.loading=!1,b.cancel=function(){d.close()},b.title="",b.productAsLines=!0,b.separator=",",b.quote='"',b.valid=function(){b.export_content="",b.loading=!0,e.post("/api/export/csv",{file:JSON.stringify(b.pcmObject),title:b.pcm.name,productAsLines:b.productAsLines,separator:b.separator,quote:b.quote},{responseType:"text/plain",transformResponse:function(a,b){return a}}).then(function(a){b.loading=!1,b.export_content=a.data;var c=new Blob([b.export_content],{type:"text/plain"}),d=window.URL.createObjectURL(c),e=document.getElementById("saveToFile");e.href=d,e.download=b.pcm.name+".csv"},function(){b.loading=!1})}}]),angular.module("openCompareEditor").directive("ocMediawikiImporter",["componentUtils",function(a){return{restrict:"E",require:"^ocEditor",scope:{api:"="},controller:["$scope","$modal",function(a,b){a.api={open:function(){a.modalInstance=b.open({templateUrl:"io/mediawiki/modalMediaWikiImport.html",scope:a,controller:"MediaWikiImportCtrl"})}}}],link:function(a,b,c,d){a.pcmContainer=d.pcmContainer,a.$watchCollection("pcmContainer",function(b){"undefined"!=typeof b&&(a.pcmContainer=d.pcmContainer,a.pcm=d.pcmContainer.pcm,a.metadata=d.pcmContainer.metadata,a.id=d.pcmContainer.id)}),a.config=d.config,a.state=d.state}}}]),angular.module("openCompareEditor").controller("MediaWikiImportCtrl",["$rootScope","$scope","base64","openCompareServer","pcmApi",function(a,b,c,d,e){b.pcmContainers=[],b.pcmContainerNames=[],b.message="",b.loading=!1,b.url="",b.valid=function(){b.loading=!0,b.message="",d.post("/api/import/wikipedia",{url:b.url}).then(function(a){b.loading=!1,b.pcmContainers=a.data,1===a.data.length?b.selectPCM(0):b.pcmContainers.forEach(function(a,d){b.pcmContainerNames.push({name:c.decode(a.pcm.name),index:d})})},function(a){b.loading=!1,b.message=a.data})},b.selectPCM=function(a){var c=b.pcmContainers[a];b.pcmContainer.pcm=e.loadPCMModelFromString(JSON.stringify(c.pcm)),e.decodePCM(b.pcmContainer.pcm),b.pcmContainer.metadata=c.metadata,b.modalInstance.close()}}]),angular.module("openCompareEditor").controller("MediaWikiExportCtrl",["$rootScope","$scope","$modal","$modalInstance","openCompareServer",function(a,b,c,d,e){b.loading=!1,b.cancel=function(){d.close()},b.title="",b.export_content="",b.productAsLines=!0,b.valid=function(){b.export_content="",b.loading=!0,e.post("/api/export/wikitext",{file:JSON.stringify(b.pcmObject),productAsLines:b.productAsLines},{responseType:"text/plain",transformResponse:function(a,b){return a}}).then(function(a){b.loading=!1,b.export_content=a.data},function(){b.loading=!1})}}]),angular.module("openCompareEditor").directive("ocHtmlImporter",["componentUtils",function(a){return{restrict:"E",require:"^ocEditor",scope:{api:"="},controller:["$scope","$modal",function(a,b){a.api={open:function(){a.modalInstance=b.open({templateUrl:"io/html/modalHtmlImport.html",scope:a,controller:"HtmlImportCtrl"})}}}],link:function(a,b,c,d){a.pcmContainer=d.pcmContainer,a.$watchCollection("pcmContainer",function(b){"undefined"!=typeof b&&(a.pcmContainer=d.pcmContainer,a.pcm=d.pcmContainer.pcm,a.metadata=d.pcmContainer.metadata,a.id=d.pcmContainer.id)}),a.config=d.config,a.state=d.state}}}]),angular.module("openCompareEditor").controller("HtmlImportCtrl",["$rootScope","$scope","$modalInstance","openCompareServer","pcmApi",function(a,b,c,d,e){b.loading=!1,b.file=null,b.title="",b.productAsLines=!0,b.message="",b.valid=function(){var a=new FormData(document.querySelector("#importHTML"));b.loading=!0,b.message="",d.post("/api/import/html",a,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then(function(a){b.loading=!1,b.pcmContainers=a.data,1===a.data.length?b.selectPCM(0):b.pcmContainers.forEach(function(a,c){b.pcmContainerNames.push({name:base64.decode(a.pcm.name),index:c})})},function(a){b.loading=!1,b.message=a.data})},b.selectPCM=function(a){var c=b.pcmContainers[a];b.pcmContainer.pcm=e.loadPCMModelFromString(JSON.stringify(c.pcm)),e.decodePCM(b.pcmContainer.pcm),b.pcmContainer.metadata=c.metadata,b.modalInstance.close()}}]),angular.module("openCompareEditor").controller("HtmlExportCtrl",["$rootScope","$scope","$modal","$modalInstance","openCompareServer",function(a,b,c,d,e){b.loading=!1,b.cancel=function(){d.close()},b.title="",b.productAsLines=!0,b.valid=function(){b.export_content="",b.loading=!0,e.post("/api/export/html",{file:JSON.stringify(b.pcmObject),title:b.pcm.title,productAsLines:b.productAsLines},{responseType:"text/plain",transformResponse:function(a,b){return a}}).then(function(a){b.loading=!1,b.export_content=a.data},function(){b.loading=!1})}}]),angular.module("openCompareEditor").controller("JsonExportCtrl",["$rootScope","$scope","$modal","$modalInstance","openCompareServer",function(a,b,c,d,e){b.loading=!1,b.cancel=function(){d.close()},b["export"]=function(){b.export_content="",b.loading=!0,e.post("/api/export/json",{file:JSON.stringify(b.pcmObject)},{responseType:"text/plain",transformResponse:function(a,b){return a}}).then(function(a){b.loading=!1,b.export_content=a.data},function(){b.loading=!1})}}]),angular.module("openCompareEditor").run(["$templateCache",function(a){a.put("charts/charts.html",'<div class="panel panel-default" id="chartPanel" ng-class="{&quot;hideBlock&quot; : !showChartPanel, &quot;showBlock&quot; : showChartPanel}"> <div class="panel-heading"> <div class="row"> <div class="col-md-6"> <h3 class="panel-title"><i style="cursor: pointer" class="mdi-action-open-with"></i> Charts</h3> </div> <div class="col-md-1 col-md-offset-5" style="height: 26px"> <button class="btn btn-flat btn-xs" ng-click="closeCharts(true)" style="padding: 0; margin-top:-1px"><i class="mdi-navigation-close"></i></button> </div> </div> </div> <div class="panel-body"> <ul class="nav nav-pills" role="tablist"> <li class="active"><a class="btn-primary" ng-show="showLineChart" id="lineTab" href="#line" role="tab" data-toggle="tab">Line chart (<i class="fa fa-500px"></i>)</a></li> <li><a ng-show="showBarChart" id="barTab" href="#bar" role="tab" data-toggle="tab">Bar chart (<i class="fa fa-500px"></i>)</a></li> <li><a ng-show="showPieChart" id="pieTab" href="#pie" role="tab" data-toggle="tab">Pie chart (<i class="fa fa-check"></i>/<i class="fa fa-times"></i>)</a></li> <li><a ng-show="showRadarChart" id="radarTab" href="#radar" role="tab" data-toggle="tab">Radar chart (<i class="fa fa-check"></i>/<i class="fa fa-times"></i>)</a></li> <li><a ng-show="showStringPieChart" id="stringPieTab" href="#stringPie" role="tab" data-toggle="tab">Pie chart (<i class="fa fa-header"></i>)</a></li> <li><a ng-show="showStringRadarChart" id="stringRadarTab" href="#stringRadar" role="tab" data-toggle="tab">Radar chart (<i class="fa fa-header"></i>)</a></li> </ul> <div class="tab-content"> <div class="tab-pane active" id="line"> <canvas ng-if="showLineChart" id="line" class="chart chart-line" data="lineData" labels="lineLabels" legend="true" series="lineSeries" responsive="true"></canvas> </div> <div class="tab-pane" id="bar"> <canvas ng-if="showBarChart" id="bar" class="chart chart-bar" data="barData" labels="barLabels" series="barSeries" legend="true"></canvas> </div> <div class="tab-pane" id="pie"> <h3 ng-repeat="serie in pieSeries">{{serie}}</h3> <canvas ng-if="showPieChart" id="pie" class="chart chart-pie" data="pieData" labels="pieLabels" legend="true" colours="colors"></canvas> </div> <div class="tab-pane" id="radar"> <h3 ng-repeat="serie in radarSeries">{{serie}}</h3> <canvas ng-if="showRadarChart" id="radar" class="chart chart-radar" data="radarData" labels="radarLabels"></canvas> </div> <div class="tab-pane" id="stringPie"> <h3>{{stringPieSeries[0]}}</h3> <canvas ng-if="showStringPieChart" id="pie" class="chart chart-pie" data="stringPieData" labels="stringPieLabels" legend="true"></canvas> </div> <div class="tab-pane" id="stringRadar"> <h3>{{stringRadarSeries[0]}}</h3> <canvas ng-if="showStringRadarChart" id="radar" class="chart chart-radar" data="stringRadarData" labels="stringRadarLabels"></canvas> </div> </div> </div> </div>'),a.put("configurator/configurator.html",'<div class="col-md-3 panel panel-default" style="margin-right: 10px"> <div class="list-group panel-body"> <div class="list-group-item"> <div class="row-action-primary"> </div> <div class="row-content"> <div class="least-content">Search</div> <p class="list-group-item-heading">Product</p> <p class="list-group-item-text"> <input class="form-control floating-label" ng-change="applyProductFilter()" type="text" placeholder="Find" ng-model="productFilter"> </p> </div> </div> <div class="list-group-separator"></div> <div class="list-group-item" ng-if="booleanFeatures.length > 0"> <div class="row-action-primary"> </div> <div class="row-content" ng-init="limit.boolean=5"> <div class="least-content"> <button ng-show="limit.boolean == 0" ng-click="limit.boolean = 5" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-less"></i></button> <button ng-show="limit.boolean != 0" ng-click="limit.boolean = 0" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-more"></i></button> </div> <p class="list-group-item-heading">Features</p> <p class="list-group-item-text"> <div class="checkbox checkbox-primary" ng-repeat="feature in booleanFeatures | limitTo: limit.boolean"> <label> <input type="checkbox" ng-model="booleanFilter" ng-change="updateFilterWithThisFeature(feature.name, feature.type)"> {{feature.displayName}} </label> </div> <button ng-show="booleanFeatures.length > 5 && limit.boolean != booleanFeatures.length && limit.boolean != 0" ng-click="limit.boolean = booleanFeatures.length" class="btn btn-flat btn-primary btn-xs">Show more <i class="mdi-navigation-expand-more"></i></button> <button ng-show="booleanFeatures.length > 5 && limit.boolean == booleanFeatures.length" ng-click="limit.boolean = 5" class="btn btn-flat btn-primary btn-xs">Show less <i class="mdi-navigation-expand-less"></i></button> </p> </div> </div> <div class="list-group-item" ng-if="stringFeatures.length > 0" ng-repeat="feature in stringFeatures"> <div class="row-action-primary"> </div> <div class="row-content"> <div class="least-content"> <button ng-show="limit[feature.displayName] == 0" ng-click="limit[feature.displayName] = 5" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-less"></i></button> <button ng-show="limit[feature.displayName] != 0" ng-click="limit[feature.displayName] = 0" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-more"></i></button> </div> <p class="list-group-item-heading">{{feature.displayName}}</p> <p class="list-group-item-text" ng-init="limit[feature.displayName]=5"> <div class="checkbox checkbox-primary" ng-repeat="value in getUniqueValues(feature.name) | limitTo:limit[feature.displayName]"> <label> <input type="checkbox" ng-model="stringFilter" ng-change="updateFilterWithThisFeature(feature.name, feature.type, value)"> {{value}} </label> </div> <button ng-if="limit[feature.displayName] != 0 && getUniqueValues(feature.name).length > 5 && limit[feature.displayName] != getUniqueValues(feature.name).length" ng-click="limit[feature.displayName] = getUniqueValues(feature.name).length" class="btn btn-flat btn-primary btn-xs">Show more <i class="mdi-navigation-expand-more"></i></button> <button ng-if="getUniqueValues(feature.name).length > 5 &&limit[feature.displayName] == getUniqueValues(feature.name).length" ng-click="limit[feature.displayName] = 5" class="btn btn-flat btn-primary btn-xs">Show less <i class="mdi-navigation-expand-less"></i></button> </p> </div> <div class="list-group-separator"></div> </div> <div class="list-group-separator" ng-if="booleanFeatures.length > 0"></div> <div class="list-group-item" ng-if="numberFeatures.length > 0" ng-repeat="feature in numberFeatures"> <div class="row-action-primary"> </div> <div class="row-content"> <div class="least-content">Number</div> <p class="list-group-item-heading">{{feature.displayName}}</p> <p class="list-group-item-text"> <div ui-slider="slider[feature.name].options" name="{{feature.name}}" ng-model="slider[feature.name].values"></div> <div class="row"> <div class="col-md-3"> <span>{{slider[feature.name].values[0]}}</span> </div> <div class="col-md-3 col-md-offset-6" style="text-align: right"> <span>{{slider[feature.name].values[1]}}</span> </div> </div> </p> </div> <div class="list-group-separator"></div> </div> </div> </div> <div class="col-md-8"> <div class="col-md-1"> <button type="button" ng-show="state.configurator && !state.lineView" style="padding: 5px" class="btn btn-flat btn-primary btn-sm" ng-click="setLineView(true)"><i class="mdi-action-view-headline"></i></button> <button type="button" ng-show="state.configurator && state.lineView" style="padding: 5px" class="btn btn-flat btn-primary btn-sm" ng-click="setLineView(false)"><i class="mdi-image-grid-on"></i></button> </div> </div> <div class="col-md-8" ng-show="state.lineView"> <div class="row"> <div class="list-group" ng-init="showProduct = []"> <div class="list-group-item" style="margin:5px" ng-repeat="product in (filteredData = (data | filter:isInFilter | startFrom:currentPage*pageSize | limitTo:pageSize))"> <div class="row-action-primary"> </div> <div class="row-content panel panel-default" ng-init="showProduct[productsKey.name] = true"> <div class="panel-heading"> <div class="least-content"> <button ng-show="!showProduct[productsKey.name]" ng-click="showProduct[productsKey.name] = true" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-less"></i></button> <button ng-show="showProduct[productsKey.name]" ng-click="showProduct[productsKey.name] = false" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-more"></i></button> </div> <h4 class="list-group-item-heading">{{product[productsKey.name]}}</h4> </div> <div class="panel-body" ng-show="showProduct[productsKey.name]"> <p class="list-group-item-text"> <div class="row" ng-repeat="feature in stringFeatures" ng-if="product[feature.name] != \'\'"> <div class="col-md-6"><h5>{{feature.displayName}}</h5></div> <div class="col-md-6"><p>{{product[feature.name]}}</p></div> <div class="list-group-separator"></div> </div> <div class="row" ng-repeat="feature in numberFeatures" ng-if="product[feature.name] != \'\'"> <div class="col-md-6"><h5>{{feature.displayName}}</h5></div> <div class="col-md-6"><p>{{product[feature.name]}}</p></div> <div class="list-group-separator"></div> </div> <div class="row" ng-if="booleanFeatures.length > 0"> <div class="col-md-12"> <div class="col-md-6"><h5>Features</h5></div> <div class="col-md-6"> <span ng-repeat="feature in booleanFeatures" ng-if="product[feature.name] != \'\' && hasThisFeature(product[feature.name])">{{feature.displayName}}, </span> </div> </div> </div> </p> </div> </div> <div class="list-group-separator" ng-if="numberFeatures.length > 0"></div> </div> </div> </div> <div class="row"> <div class="col-md-2 col-md-offset-2"> <select ng-model="pageSize" class="form-control" id="select" name="pageSize"> <option value="5">5 per page</option> <option value="10">10 per page</option> <option value="25">25 per page</option> <option value="50">50 per page</option> <option value="100">100 per page</option> </select> </div> <div class="col-md-4"> <button class="btn btn-primary" ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1"> Previous </button> {{currentPage+1}}/{{numberOfPages()}} <button class="btn btn-primary" ng-disabled="currentPage >= length/pageSize - 1" ng-click="currentPage=currentPage+1"> Next </button> </div> </div> </div>'),a.put("creator/creator.html",'<div class="modal fade in" id="modalCreator" data-backdrop="static" data-keyboard="false"> <div class="modal-dialog modal-lg"> <div class="modal-content"> <div class="modal-header"> <h4 class="modal-title">Welcome to your table creator</h4> <br> </div> <div class="modal-body"> <form class="form-horizontal"> <div class="form-group" style="margin-bottom: 20px"> <p>Start by giving a title to your table:</p> <div class="col-lg-12"> <input type="text" class="form-control" id="title" placeholder="Title" ng-model="title"> </div> </div> <div class="form-group"> <p>Now choose a size:</p> <label for="rows" class="col-lg-4 control-label">Number of rows:</label> <div class="col-lg-8"> <input type="number" class="form-control" id="rows" placeholder="Rows" ng-model="rows"> </div> <br> <label for="columns" class="col-lg-4 control-label">Number of columns:</label> <div class="col-lg-8"> <input type="number" class="form-control" id="columns" placeholder="Columns" ng-model="columns"> </div> </div> </form> </div> <div class="modal-footer"> <a type="button" class="btn btn-default" href="/">{{ "edit.button.cancel" | translate }}</a> <button data-dismiss="modal" aria-hidden="true" type="button" class="btn btn-primary" ng-click="launchCreation()"> Launch creation </button> </div> </div> </div> </div>'),a.put("grid/templates/pcmEditor.html",'<div id="editor" ng-controller="EditorCtrl"> <div class="modal fade" id="modalRemove" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.button.confirm" | translate }}</h4> </div> <div class="modal-body"> {{ "edit.warning.removeIsDefinitive" | translate }} </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-danger" data-dismiss="modal" ng-click="remove()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalCancel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.confirm" | translate }}</h4> </div> <div class="modal-body"> {{ "edit.warning.cancelWillLoseChanges" | translate }} </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.no" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="cancel()">{{ "edit.button.yes" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalNewFeature" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog modal-lg"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.createNewFeature" | translate }}</h4> </div> <div class="modal-body"> <label for="featureName">{{ "edit.title.featureName" | translate }}: </label> <input ng-model="featureName" type="text" id="featureName"> <label for="featureType">{{ "edit.title.featureType" | translate }}: </label> <select ng-model="featureType" name="featureType"> <option value="string" selected>{{ "edit.type.string" | translate }}</option> <option value="num">{{ "edit.type.number" | translate }}</option> <option value="bool">{{ "edit.type.boolean" | translate }}</option> <!--<option value="image">Image</option>--> </select> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="addFeature()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalRenameFeature" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.renameFeature" | translate }}</h4> </div> <div class="modal-body"> <label for="featureName">Feature name: </label> <input ng-model="featureName" type="text" id="featureName" value="{featureName}"> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="renameFeature()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalChangeType" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.renameFeature" | translate }}</h4> </div> <div class="modal-body"> <label for="featureType">{{ "edit.title.featureType" | translate }}: </label> <select ng-model="featureType"> <option value="string">{{ "edit.type.string" | translate }}</option> <option value="num">{{ "edit.type.number" | translate }}</option> <option value="bool">{{ "edit.type.boolean" | translate }}</option> </select> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="changeType()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalSlider" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <span class="help-block">{{ "edit.title.selectRange" | translate }}</span> </div> <div class="modal-body"> <div ui-slider="slider.options" ng-model="filterSlider"></div> <div class="btn-group"> <button class="btn btn-primary btn-raised btn-sm">{{ "edit.title.from" | translate }} :</button> <input type="number" class="btn btn-default btn-raised btn-sm" ng-blur="checkFilterSliderMin()" ng-model="filterSlider[0]"> <button class="btn btn-primary btn-raised btn-sm">{{ "edit.title.to" | translate }} :</button> <input type="number" class="btn btn-default btn-raised btn-sm" ng-blur="checkFilterSliderMax()" ng-model="filterSlider[1]"> </div> <p></p> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-primary btn-raised btn-sm" data-dismiss="modal" ng-click="closeFilter()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalStringFilter" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <span class="help-block">{{ "edit.title.selectProducts" | translate }} :</span> </div> <div class="modal-body"> <div id="grid2" ui-grid="gridOptions2" ui-grid-selection ui-grid-resize-columns ui-grid-auto-resize></div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-primary btn-raised btn-sm" data-dismiss="modal" ng-click="closeFilter()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <!-- Table editor --> <div class="row"> <oc-configurator ng-show="state.configurator"></oc-configurator> <div ng-show="!state.configurator || (state.configurator && !state.lineView)" id="matrix" class="grid" ng-class="{\'col-md-8\': state.configurator, \'col-md-12\': !state.configurator}" ng-style="{\'height\' : height}" ui-grid="gridOptions" ui-grid-selection ui-grid-edit ui-grid-cellnav ui-grid-resize-columns ui-grid-move-columns ui-grid-auto-resize ui-grid-pinning> <div class="grid-overlay-msg" ng-show="loading"> <div class="msg"> <span class="loader"> Loading Data...</span> </div> </div> </div> </div> </div>'),a.put("io/csv/modalCsvImport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="$dismiss()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Import a PCM from CSV</h4> </div> <div class="modal-body"> <div ng-show="message" class="alert alert-danger" role="alert">{{message}}</div> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post" enctype="multipart/form-data"> <div class="form-group"> <label class="col-md-4 control-label">Csv file</label> <div class="col-md-8"> <input type="file" id="file" required file-model="file"> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Title</label> <div class="col-md-8"> <input ng-model="title" class="form-control" type="text" id="title" required> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" id="productAsLines" size="3"> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Separator</label> <div class="col-md-1"> <input ng-model="separator" type="text" id="separator" size="3" required> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Quote</label> <div class="col-md-1"> <input ng-model="quote" type="text" id="quote" size="3"> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="$dismiss()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <span ng-show="!loading">Import</span> </button> </div>'),a.put("io/html/modalHtmlImport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="$dismiss()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Import a PCM from HTML</h4> </div> <div class="modal-body"> <div ng-show="message" class="alert alert-danger" role="alert">{{message}}</div> <form name="importHTML" id="importHTML" class="form-horizontal" method="post"> <div class="form-group"> <label class="col-md-4 control-label">Title</label> <div class="col-md-8"> <input ng-model="title" class="form-control" type="text" name="title" required> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" name="productAsLines" size="3" value="true"> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Copy paste your code</label> <div> <textarea ng-model="content" rows="25" name="content" style="min-width: 100%" required></textarea> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="$dismiss()">Cancel</button> <button type="submit" class="btn btn-success" form="importHTML" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <span ng-show="!loading">Import</span> </button> </div>'),
a.put("io/mediawiki/modalMediaWikiImport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="$dismiss()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Import a PCM from Wikipedia</h4> </div> <div class="modal-body"> <div ng-show="message" class="alert alert-danger" role="alert">{{message}}</div> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post"> <div class="form-group"> <label class="col-md-3 control-label">Page URL</label> <div class="col-md-9"> <input ng-model="url" class="form-control" type="text" name="url" id="url" required> </div> </div> </form> <div ng-if="pcmContainers.length > 0"> <form class="form"> <div class="form-group"> <label class="control-label">Please select a matrix to edit</label> <ul class="list-group"> <button ng-repeat="pcmContainerName in pcmContainerNames" type="button" class="btn btn-primary btn-flat btn-xs list-group-item" ng-click="selectPCM(pcmContainerName.index)"> {{pcmContainerName.name}} </button> </ul> </div> </form> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="$dismiss()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <span ng-show="!loading">Import</span> </button> </div>'),a.put("templates/cellTemplate.html",'<div class="ui-grid-cell-contents" title="TOOLTIP"> <div ng-if="grid.appScope.gridOptions.rowHeight <= 40" class="ngCellText" ng-class="col.colIndex()" style="overflow:hidden; text-overflow: ellipsis;white-space: nowrap"> <span ng-cell-text translate="{{COL_FIELD}}" translate-values="{param_1: row.entity.param_1, param_2: row.entity.param_2, param_3: row.entity.param_3, param_4: row.entity.param_4}"> {{COL_FIELD CUSTOM_FILTERS}} </span> </div> <div ng-if="grid.appScope.gridOptions.rowHeight > 40" class="ngCellText" ng-class="col.colIndex()"> <span ng-cell-text translate="{{COL_FIELD}}" translate-values="{param_1: row.entity.param_1, param_2: row.entity.param_2, param_3: row.entity.param_3, param_4: row.entity.param_4}"> {{COL_FIELD CUSTOM_FILTERS}} </span> </div> </div>'),a.put("templates/featureGroupHeader.html",'<div class="ui-grid-header custom-ui-grid-header"> <div class="ui-grid-top-panel"> <div class="ui-grid-header-viewport"> <div class="ui-grid-header-canvas"> <div class="ui-grid-header-cell-wrapper" style="display: block" ng-style="colContainer.headerCellWrapperStyle()"> <div class="ui-grid-header-cell-row" ng-show="grid.options.superColDefs.length != 0" ng-if="colContainer.name === \'body\'" style="display:block;border-left:  1px solid #d4d4d4;height:30px"> <div class="ui-grid-header-cell" ng-repeat="superCol in grid.options.superColDefs track by $index" col-name="{{superCol.name}}"> <div class="ui-grid-cell-contents" ng-bind="superCol.displayName"> </div> <div class="ui-grid-column-menu-button" ng-show="superCol.name != \'emptyFeatureGroup\'"> <a class="dropdown-toggle" data-toggle="dropdown" data-target="#" style="cursor:pointer;color:#515151"> <i class="ui-grid-icon-angle-down"></i> </a> <ul class="dropdown-menu" ng-controller="FeatureGroupCtrl" style="left: -140px"> <li><a href="#" ng-click="openRenameFeatureGroupModal(superCol.name)"><i class="fa fa-pencil"></i> Rename</a></li> <li><a href="#" ng-click="grid.appScope.deleteFeatureGroup(superCol.name)"><i class="fa fa-trash"></i> Remove</a></li> <li><a href="#" ng-click="openAssignFeatureGroupModal(superCol.name, grid.options.columnDefs)"><i class="fa fa-link"></i> Assign</a></li> </ul> </div> </div> </div> <div class="ui-grid-header-cell-row" ng-show="grid.options.superColDefs.length != 0" ng-if="colContainer.name !== \'body\'" style="display: block;height:30px"> <br> </div> <div class="ui-grid-header-cell-row"> <div class="ui-grid-header-cell ui-grid-clearfix" ng-repeat="col in colContainer.renderedColumns track by col.colDef.name" ui-grid-header-cell col="col" super-col-width-update render-index="$index"> </div> </div> </div> </div> </div> </div> </div>'),a.put("templates/modal/modalAssignFeatureGroup.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancelModal()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.assignFeatureGroup" | translate }}</h4> </div> <div class="modal-body" ng-init="checkbox = []"> <h4>{{currentFeatureGroup}} </h4> <label for="featureName">Features :</label> <div class="checkbox checkbox-primary" name="featuresSelection" ng-repeat="col in cols | filter:isAFeature" ng-init="checkbox[col.name] = isAFeatureWithThisFeatureGroup(col, currentFeatureGroup)"> <label> <input type="checkbox" ng-model="checkbox[col.name]"> {{ col.name }} </label> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelModal()">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="assignFeatureGroup(currentFeatureGroup, checkbox)">{{ "edit.button.apply" | translate }}</button> </div>'),a.put("templates/modal/modalCsvExport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Export a PCM to CSV</h4> </div> <div class="modal-body"> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post" enctype="multipart/form-data"> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" id="productAsLines" size="3"> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Separator</label> <div class="col-md-1"> <input ng-model="separator" type="text" id="separator" size="3" required> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Quote</label> <div class="col-md-1"> <input ng-model="quote" type="text" id="quote" size="3"> </div> </div> </form> <div ng-show="export_content"> <hr> <textarea ng-model="export_content" rows="25" style="min-width: 100%"></textarea> </div> </div> <div class="modal-footer"> <a id="saveToFile" class="btn btn-default" ng-show="export_content"><i class="fa fa-download"></i></a> <button class="btn btn-default" clipboard text="export_content" ng-show="export_content"><i class="fa fa-clipboard"></i></button> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <div ng-hide="loading"> <span ng-hide="export_message">Export</span> <span ng-show="export_message">Reload</span> </div> </button> </div>'),a.put("templates/modal/modalHtmlExport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Export a PCM to HTML</h4> </div> <div class="modal-body"> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post" enctype="multipart/form-data"> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" id="productAsLines" size="3"> </div> </div> </form> <div ng-show="export_content"> <hr> <textarea ng-model="export_content" rows="25" style="min-width: 100%"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-default" clipboard text="export_content" ng-show="export_content"><i class="fa fa-clipboard"></i></button> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <div ng-hide="loading"> <span ng-hide="export_message">Export</span> <span ng-show="export_message">Reload</span> </div> </button> </div>'),a.put("templates/modal/modalJsonExport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Export a PCM to JSON</h4> </div> <div class="modal-body"> <div ng-show="export_content"> <textarea ng-model="export_content" rows="25" style="min-width: 100%"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-default" clipboard text="export_content" ng-show="export_content"><i class="fa fa-clipboard"></i></button> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" ng-click="export()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <div ng-hide="loading">Export</div> </button> </div>'),a.put("templates/modal/modalMediaWikiExport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Export a PCM to Wikipedia</h4> </div> <div class="modal-body"> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post" enctype="multipart/form-data"> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" id="productAsLines" size="3"> </div> </div> </form> <div ng-hide="!export_content"> <hr> <textarea ng-model="export_content" rows="25" style="min-width: 100%"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-default" clipboard text="export_content" ng-show="export_content"><i class="fa fa-clipboard"></i></button> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <div ng-hide="loading"> <span ng-hide="export_message">Export</span> <span ng-show="export_message">Reload</span> </div> </button> </div>'),a.put("templates/modal/modalRenameFeatureGroup.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancelModal()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.renameFeature" | translate }}</h4> </div> <div class="modal-body"> <label for="featureName">Feature name: </label> <input ng-model="newFeatureGroup" type="text" id="featureName" value="{{newFeatureGroup}}"> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelModal()">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="renameFeatureGroup(currentFeatureGroup, newFeatureGroup)">{{ "edit.button.apply" | translate }}</button> </div>'),a.put("templates/toolCellTemplate.html",'<div class="buttonsCell" ng-show="grid.appScope.state.edit"> <button role="button" class="btn btn-flat btn-default" ng-click="grid.appScope.removeProduct(row)"><i class="fa fa-times"></i></button> </div>'),a.put("title/title.html",'<div class="row"> <h3 ng-show="!state.edit">{{pcm.name}} </h3> <form class="form-horizontal" ng-show="state.edit"> <div class="form-group col-lg-5"> <label for="pcm-name" class="control-label">{{ "edit.title.placeholder" | translate }}:</label> <input id="pcm-name" class="form-control" type="text" ng-model="pcm.name" ng-change="state.saved=false" placeholder="{{ &quot;edit.title.placeholder&quot; | translate }}"> </div> </form> </div>'),a.put("toolbar/modalCreateFeatureGroup.html",'<div class="modal-header" id="createFeatureGroupModal"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancelModal()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.createNewFeatureGroup" | translate }}</h4> </div> <div class="modal-body" ng-init="checkbox = []"> <label for="featureName">{{ "edit.title.featureName" | translate }}: </label> <input ng-model="featureName" type="text" id="featureName"> <br> <label for="featuresSelection">{{ "edit.title.featureSelection" | translate }}: </label> <div class="checkbox checkbox-primary" name="featuresSelection" ng-repeat="col in state.columnDefs | filter:isAFeature" ng-init="checkbox[col.name] = false"> <label> <input type="checkbox" ng-model="checkbox[col.name]"> {{ col.name }} </label> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelModal()">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" ng-click="addFeatureGroup(featureName, checkbox);">{{ "edit.button.apply" | translate }}</button> </div>'),a.put("toolbar/toolbar.html",'<div ng-show="config.enableToolbar"> <div class="row" ng-show="config.enableExport || config.enableEdit"> <a ng-show="!launchFromCreator && !state.saved && state.edit" role="button" class="btn btn-default btn-flat btn-raised btn-sm" data-toggle="modal" data-target="#modalCancel"><i class="mdi-navigation-arrow-back"></i> {{ \'edit.button.cancel\' | translate }}</a> <a ng-show="!launchFromCreator && state.saved && state.edit" role="button" class="btn btn-default btn-flat btn-raised btn-sm" onclick="window.location.href=window.location.href"><i class="mdi-navigation-arrow-back"></i> {{ \'edit.button.cancel\' | translate }}</a> <a ng-show="launchFromCreator && state.saved && state.edit" role="button" class="btn btn-default btn-flat btn-raised btn-sm" href="/pcm/{{id}}"><i class="mdi-navigation-arrow-back"></i> {{ \'edit.button.cancel\' | translate }}</a> <a role="button" ng-show="config.enableEdit && !state.edit && !configurator" class="btn btn-default btn-flat btn-raised btn-sm" ng-click="setEdit(true, true)"><i class="mdi-editor-mode-edit"></i> {{ \'edit.button.edit\' | translate }}</a> <a role="button" ng-show="!state.edit && !state.configurator" class="btn btn-default btn-flat btn-raised btn-sm" ng-click="setConfigurator(true)"><i class="mdi-action-swap-horiz"></i> Configurator</a> <a role="button" ng-show="!state.edit && state.configurator" class="btn btn-default btn-flat btn-raised btn-sm" ng-click="setConfigurator(false)"><i class="mdi-action-swap-horiz"></i> Classic</a> <div class="btn-group"> <!-- Export --> <div class="btn-group" ng-show="config.enableExport"> <a class="btn btn-default btn-flat dropdown-toggle btn-sm" data-toggle="dropdown"><i class="mdi-action-get-app"></i> {{ \'edit.button.export\' | translate }} <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="#" ng-click="export(\'Csv\')" data-toggle="modal" data-target="#modalExport"><i class="fa fa-file-excel-o"></i> CSV</a></li> <li><a href="#" ng-click="export(\'MediaWiki\')" data-toggle="modal" data-target="#modalExport"><i class="fa fa-file-code-o"></i> Wikipedia</a></li> <li><a href="#" ng-click="export(\'Html\')" data-toggle="modal" data-target="#modalExport"><i class="fa fa-file-code-o"></i> Html</a></li> <li><a href="#" ng-click="export(\'Json\')" data-toggle="modal" data-target="#modalExport"><i class="fa fa-file-code-o"></i> JSON</a></li> </ul> </div> <!-- Share --> <div class="btn-group" ng-show="config.enableShare" ng-controller="ShareCtrl"> <a class="btn dropdown-toggle btn-flat btn-sm" data-toggle="dropdown" ng-click="updateShareLinks()"><i class="mdi-social-share"></i> {{ \'edit.button.share\' | translate }} <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="#" data-toggle="modal" data-target="#modalShare"><i class="fa fa-share"></i> {{ \'edit.button.embed\' | translate }}</a></li> <li><a href="{{ emailLink }}"><i class="fa fa-envelope-o"></i> Email</a></li> <li><a href="{{ twitterLink }}" target="_blank"><i class="fa fa-twitter"></i> Twitter</a></li> <li><a href="{{ facebookLink }}" target="_blank"><i class="fa fa-facebook"></i> Facebook</a></li> <li><a href="{{ googleLink }}" target="_blank"><i class="fa fa-google-plus"></i> Google+</a></li> <li><a href="{{ redditLink }}" target="_blank"><i class="fa fa-reddit"></i> Reddit</a></li> </ul> <!-- Embed modal --> <div class="modal fade" id="modalShare" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.embed" | translate }}</h4> </div> <div class="modal-body"> <label>Options: </label><br> <label><input type="checkbox" name="title" value="enableTitle" ng-model="enableTitleOption" ng-change="updateEmbedLink()"> {{ "edit.title.showTitle" | translate }}</label><br> <label><input type="checkbox" name="edit" value="enableEdit" ng-model="enableEditOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowEdition" | translate }}</label><br> <label><input type="checkbox" name="export" value="enableExport" ng-model="enableExportOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowExportation" | translate }}</label><br> <label><input type="checkbox" name="share" value="enableShare" ng-model="enableShareOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowSharing" | translate }}</label><br> <label><input type="checkbox" name="share" value="enableConfigurator" ng-model="enableConfiguratorOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowConfigurator" | translate }}</label><br> <label><input type="checkbox" name="share" value="enableCharts" ng-model="enableChartsOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowCharts" | translate }}</label><br> <br> <label for="code">Code: </label> <textarea id="code" rows="4" cols="60" ng-model="embedLink">\n\n                  </textarea> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> </div> </div> </div> </div> </div> </div> <!-- Height --> <div class="btn-group" ng-show="!state.edit && !(state.configurator && state.lineView)"> <a class="btn dropdown-toggle btn-flat btn-sm" data-toggle="dropdown"><i class="mdi-navigation-unfold-more"></i> {{ \'edit.button.height\' | translate }} <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a role="button" class="btn btn-flat btn-sm" ng-click="increaseHeight(1)">x 1</a></li> <li><a role="button" class="btn btn-flat btn-sm" ng-click="increaseHeight(2)">x 2</a></li> <li><a role="button" class="btn btn-flat btn-sm" ng-click="increaseHeight(4)">x 4</a></li> <li><a role="button" class="btn btn-flat btn-sm" ng-click="increaseHeight(8)">x 8</a></li> </ul> </div> <div ng-show="state.edit"> <div class="btn-group"> <a role="button" class="btn btn-default btn-sm" ng-class="{&quot;btn btn-flat btn-default &quot; : !state.saved, &quot;btn btn-success&quot;: state.saved && isTitleSet}" ng-disabled="!isTitleSet" ng-click="save()"><i class="fa" ng-class="{&quot;mdi-content-save&quot;: !state.saved, &quot;mdi-navigation-check&quot;: state.saved && isTitleSet}"></i> {{ \'edit.button.save\' | translate }}</a> <a ng-show="saved" type="button" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#modalRemove"><i class="mdi-action-delete"></i> {{ \'edit.button.remove\' | translate }}</a> <a role="button" class="btn btn-flat btn-warning btn-sm" ng-class="{&quot;btn btn-warning&quot;: state.validating, &quot;btn btn-default&quot;: !state.validating}" ng-click="toggleValidation()"><i class="fa" ng-class="{&quot;mdi-action-search&quot;: !state.validating, &quot;mdi-content-clear&quot;: state.validating}"></i> {{ \'edit.button.validate\' | translate }}</a> </div> <div class="btn-group"> <a role="button" class="btn btn-flat btn-primary btn-sm" data-toggle="modal" data-target="#modalNewFeature"><i class="mdi-content-add"></i> {{ \'edit.button.addfeature\' | translate }}</a> <a role="button" class="btn btn-flat btn-primary btn-sm" ng-click="openCreateFeatureGroupModal()"><i class="mdi-content-add-box"></i> {{ \'edit.button.addfeaturegroup\' | translate }}</a> <a role="button" class="btn btn-flat btn-primary btn-sm" ng-click="addProduct()"><i class="mdi-content-add"></i> {{ \'edit.button.addproduct\' | translate }}</a> </div> <div class="btn-group"> <a role="button" class="btn btn-flat btn-default btn-sm" ng-click="undo()" ng-disabled="!state.canUndo"><i class="mdi-content-undo"></i></a> <a role="button" class="btn btn-flat btn-default btn-sm" ng-click="redo()" ng-disabled="!state.canRedo"><i class="mdi-content-redo"></i></a> </div> </div> </div> </div>')}]);
